<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="http://deepstream.io">deepstream.io (v2.2.0)</a>
</h1>
<h4>a scalable server for realtime webapps</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io">module deepstream.io</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io">
            function <span class="apidocSignatureSpan">deepstream.</span>io
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io.config_permission_handler">
            function <span class="apidocSignatureSpan">deepstream.io.</span>io.config_permission_handler
            <span class="apidocSignatureSpan">(options, config)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io.dependency_initialiser">
            function <span class="apidocSignatureSpan">deepstream.io.</span>io.dependency_initialiser
            <span class="apidocSignatureSpan">(options, name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io.event_handler">
            function <span class="apidocSignatureSpan">deepstream.io.</span>io.event_handler
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io.json_path">
            function <span class="apidocSignatureSpan">deepstream.io.</span>io.json_path
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io.record_deletion">
            function <span class="apidocSignatureSpan">deepstream.io.</span>io.record_deletion
            <span class="apidocSignatureSpan">(options, socketWrapper, message, successCallback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io.record_handler">
            function <span class="apidocSignatureSpan">deepstream.io.</span>io.record_handler
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io.record_request">
            function <span class="apidocSignatureSpan">deepstream.io.</span>io.record_request
            <span class="apidocSignatureSpan">(recordName, options, socketWrapper, onComplete, onError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io.record_transition">
            function <span class="apidocSignatureSpan">deepstream.io.</span>io.record_transition
            <span class="apidocSignatureSpan">(name, options, recordHandler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io.rule_application">
            function <span class="apidocSignatureSpan">deepstream.io.</span>io.rule_application
            <span class="apidocSignatureSpan">(params)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io.rule_cache">
            function <span class="apidocSignatureSpan">deepstream.io.</span>io.rule_cache
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io.socket_wrapper">
            function <span class="apidocSignatureSpan">deepstream.io.</span>io.socket_wrapper
            <span class="apidocSignatureSpan">(socket, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.io.std_out_logger">
            function <span class="apidocSignatureSpan">deepstream.io.</span>io.std_out_logger
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.readMessage">
            function <span class="apidocSignatureSpan">deepstream.io.</span>readMessage
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.super_">
            function <span class="apidocSignatureSpan">deepstream.io.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>constants</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.config_compiler</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.config_initialiser</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.config_permission_handler.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.config_validator</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.default_options</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.dependency_initialiser.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.event_handler.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.file_utils</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.js_yaml_loader</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.json_path.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.message_builder</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.noop_message_connector</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.noop_storage</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.path_parser</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.pid_helper</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.record_deletion.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.record_handler.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.record_request.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.record_transition.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.rule_application.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.rule_cache.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.rule_parser</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.rules_map</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.socket_wrapper.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.std_out_logger.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.</span>io.utils</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.config_compiler">module deepstream.io.config_compiler</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_compiler.compile">
            function <span class="apidocSignatureSpan">deepstream.io.config_compiler.</span>compile
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.config_initialiser">module deepstream.io.config_initialiser</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_initialiser.initialise">
            function <span class="apidocSignatureSpan">deepstream.io.config_initialiser.</span>initialise
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.config_permission_handler">module deepstream.io.config_permission_handler</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_permission_handler.config_permission_handler">
            function <span class="apidocSignatureSpan">deepstream.io.</span>config_permission_handler
            <span class="apidocSignatureSpan">(options, config)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_permission_handler.super_">
            function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.config_permission_handler.prototype">module deepstream.io.config_permission_handler.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_permission_handler.prototype._getCompiledRulesForName">
            function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>_getCompiledRulesForName
            <span class="apidocSignatureSpan">(name, ruleSpecification)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_permission_handler.prototype._onConfigLoaded">
            function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>_onConfigLoaded
            <span class="apidocSignatureSpan">(filePath, loadError, config)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_permission_handler.prototype._ready">
            function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>_ready
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_permission_handler.prototype.canPerformAction">
            function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>canPerformAction
            <span class="apidocSignatureSpan">( username, message, callback, authData)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_permission_handler.prototype.init">
            function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>init
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_permission_handler.prototype.loadConfig">
            function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>loadConfig
            <span class="apidocSignatureSpan">(filePath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_permission_handler.prototype.setRecordHandler">
            function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>setRecordHandler
            <span class="apidocSignatureSpan">(recordHandler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_permission_handler.prototype.useConfig">
            function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>useConfig
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.config_validator">module deepstream.io.config_validator</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.config_validator.validate">
            function <span class="apidocSignatureSpan">deepstream.io.config_validator.</span>validate
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.default_options">module deepstream.io.default_options</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.default_options.get">
            function <span class="apidocSignatureSpan">deepstream.io.default_options.</span>get
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.dependency_initialiser">module deepstream.io.dependency_initialiser</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.dependency_initialiser.dependency_initialiser">
            function <span class="apidocSignatureSpan">deepstream.io.</span>dependency_initialiser
            <span class="apidocSignatureSpan">(options, name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.dependency_initialiser.super_">
            function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.dependency_initialiser.prototype">module deepstream.io.dependency_initialiser.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.dependency_initialiser.prototype._emitReady">
            function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.prototype.</span>_emitReady
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.dependency_initialiser.prototype._logError">
            function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.prototype.</span>_logError
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.dependency_initialiser.prototype._onError">
            function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.prototype.</span>_onError
            <span class="apidocSignatureSpan">(error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.dependency_initialiser.prototype._onReady">
            function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.prototype.</span>_onReady
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.dependency_initialiser.prototype._onTimeout">
            function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.prototype.</span>_onTimeout
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.dependency_initialiser.prototype.getDependency">
            function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.prototype.</span>getDependency
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.event_handler">module deepstream.io.event_handler</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.event_handler.event_handler">
            function <span class="apidocSignatureSpan">deepstream.io.</span>event_handler
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.event_handler.prototype">module deepstream.io.event_handler.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.event_handler.prototype._addSubscriber">
            function <span class="apidocSignatureSpan">deepstream.io.event_handler.prototype.</span>_addSubscriber
            <span class="apidocSignatureSpan">(socket, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.event_handler.prototype._removeSubscriber">
            function <span class="apidocSignatureSpan">deepstream.io.event_handler.prototype.</span>_removeSubscriber
            <span class="apidocSignatureSpan">(socket, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.event_handler.prototype._sendError">
            function <span class="apidocSignatureSpan">deepstream.io.event_handler.prototype.</span>_sendError
            <span class="apidocSignatureSpan">(socket, event, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.event_handler.prototype._triggerEvent">
            function <span class="apidocSignatureSpan">deepstream.io.event_handler.prototype.</span>_triggerEvent
            <span class="apidocSignatureSpan">(socket, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.event_handler.prototype.handle">
            function <span class="apidocSignatureSpan">deepstream.io.event_handler.prototype.</span>handle
            <span class="apidocSignatureSpan">(socket, message)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.file_utils">module deepstream.io.file_utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.file_utils.fileExistsSync">
            function <span class="apidocSignatureSpan">deepstream.io.file_utils.</span>fileExistsSync
            <span class="apidocSignatureSpan">(filePath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.file_utils.lookupConfRequirePath">
            function <span class="apidocSignatureSpan">deepstream.io.file_utils.</span>lookupConfRequirePath
            <span class="apidocSignatureSpan">(filePath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.file_utils.lookupLibRequirePath">
            function <span class="apidocSignatureSpan">deepstream.io.file_utils.</span>lookupLibRequirePath
            <span class="apidocSignatureSpan">(filePath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.file_utils.lookupRequirePath">
            function <span class="apidocSignatureSpan">deepstream.io.file_utils.</span>lookupRequirePath
            <span class="apidocSignatureSpan">(filePath, prefix)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.js_yaml_loader">module deepstream.io.js_yaml_loader</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.js_yaml_loader.loadConfig">
            function <span class="apidocSignatureSpan">deepstream.io.js_yaml_loader.</span>loadConfig
            <span class="apidocSignatureSpan">(filePath, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.js_yaml_loader.loadConfigWithoutInitialisation">
            function <span class="apidocSignatureSpan">deepstream.io.js_yaml_loader.</span>loadConfigWithoutInitialisation
            <span class="apidocSignatureSpan">(filePath, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.js_yaml_loader.readAndParseFile">
            function <span class="apidocSignatureSpan">deepstream.io.js_yaml_loader.</span>readAndParseFile
            <span class="apidocSignatureSpan">(filePath, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.json_path">module deepstream.io.json_path</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.json_path.json_path">
            function <span class="apidocSignatureSpan">deepstream.io.</span>json_path
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.json_path.prototype">module deepstream.io.json_path.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.json_path.prototype._tokenize">
            function <span class="apidocSignatureSpan">deepstream.io.json_path.prototype.</span>_tokenize
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.json_path.prototype.setValue">
            function <span class="apidocSignatureSpan">deepstream.io.json_path.prototype.</span>setValue
            <span class="apidocSignatureSpan">(node, value)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.message_builder">module deepstream.io.message_builder</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.message_builder.getErrorMsg">
            function <span class="apidocSignatureSpan">deepstream.io.message_builder.</span>getErrorMsg
            <span class="apidocSignatureSpan">(topic, type, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.message_builder.getMsg">
            function <span class="apidocSignatureSpan">deepstream.io.message_builder.</span>getMsg
            <span class="apidocSignatureSpan">(topic, action, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.message_builder.typed">
            function <span class="apidocSignatureSpan">deepstream.io.message_builder.</span>typed
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.noop_message_connector">module deepstream.io.noop_message_connector</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">deepstream.io.noop_message_connector.</span>isReady</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.noop_message_connector.publish">
            function <span class="apidocSignatureSpan">deepstream.io.noop_message_connector.</span>publish
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.noop_message_connector.subscribe">
            function <span class="apidocSignatureSpan">deepstream.io.noop_message_connector.</span>subscribe
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.noop_message_connector.unsubscribe">
            function <span class="apidocSignatureSpan">deepstream.io.noop_message_connector.</span>unsubscribe
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.noop_storage">module deepstream.io.noop_storage</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">deepstream.io.noop_storage.</span>isReady</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.noop_storage.delete">
            function <span class="apidocSignatureSpan">deepstream.io.noop_storage.</span>delete
            <span class="apidocSignatureSpan">(key, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.noop_storage.get">
            function <span class="apidocSignatureSpan">deepstream.io.noop_storage.</span>get
            <span class="apidocSignatureSpan">(key, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.noop_storage.set">
            function <span class="apidocSignatureSpan">deepstream.io.noop_storage.</span>set
            <span class="apidocSignatureSpan">(key, value, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.path_parser">module deepstream.io.path_parser</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.path_parser.parse">
            function <span class="apidocSignatureSpan">deepstream.io.path_parser.</span>parse
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.path_parser.validate">
            function <span class="apidocSignatureSpan">deepstream.io.path_parser.</span>validate
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.pid_helper">module deepstream.io.pid_helper</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.pid_helper.ensureNotRunning">
            function <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>ensureNotRunning
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.pid_helper.exit">
            function <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>exit
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.pid_helper.isRunning">
            function <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>isRunning
            <span class="apidocSignatureSpan">(pid)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.pid_helper.read">
            function <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>read
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.pid_helper.save">
            function <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>save
            <span class="apidocSignatureSpan">(pid, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.pid_helper.stop">
            function <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>stop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>PID_FILE</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.record_deletion">module deepstream.io.record_deletion</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_deletion.record_deletion">
            function <span class="apidocSignatureSpan">deepstream.io.</span>record_deletion
            <span class="apidocSignatureSpan">(options, socketWrapper, message, successCallback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.record_deletion.prototype">module deepstream.io.record_deletion.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_deletion.prototype._checkIfDone">
            function <span class="apidocSignatureSpan">deepstream.io.record_deletion.prototype.</span>_checkIfDone
            <span class="apidocSignatureSpan">(timeoutId, error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_deletion.prototype._destroy">
            function <span class="apidocSignatureSpan">deepstream.io.record_deletion.prototype.</span>_destroy
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_deletion.prototype._done">
            function <span class="apidocSignatureSpan">deepstream.io.record_deletion.prototype.</span>_done
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_deletion.prototype._handleError">
            function <span class="apidocSignatureSpan">deepstream.io.record_deletion.prototype.</span>_handleError
            <span class="apidocSignatureSpan">(errorMsg)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.record_handler">module deepstream.io.record_handler</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.record_handler">
            function <span class="apidocSignatureSpan">deepstream.io.</span>record_handler
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.record_handler.prototype">module deepstream.io.record_handler.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype._create">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_create
            <span class="apidocSignatureSpan">(recordName, socketWrapper)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype._createOrRead">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_createOrRead
            <span class="apidocSignatureSpan">(socketWrapper, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype._delete">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_delete
            <span class="apidocSignatureSpan">(socketWrapper, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype._hasRecord">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_hasRecord
            <span class="apidocSignatureSpan">(socketWrapper, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype._head">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_head
            <span class="apidocSignatureSpan">(socketWrapper, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype._onDeleted">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_onDeleted
            <span class="apidocSignatureSpan">(name, message, originalSender)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype._permissionAction">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_permissionAction
            <span class="apidocSignatureSpan">( action, recordName, socketWrapper, successCallback )</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype._read">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_read
            <span class="apidocSignatureSpan">(recordName, record, socketWrapper)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype._sendRecord">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_sendRecord
            <span class="apidocSignatureSpan">(recordName, record, socketWrapper)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype._snapshot">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_snapshot
            <span class="apidocSignatureSpan">(socketWrapper, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype._update">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_update
            <span class="apidocSignatureSpan">(socketWrapper, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype.handle">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>handle
            <span class="apidocSignatureSpan">(socketWrapper, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype.removeRecordRequest">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>removeRecordRequest
            <span class="apidocSignatureSpan">(recordName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_handler.prototype.runWhenRecordStable">
            function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>runWhenRecordStable
            <span class="apidocSignatureSpan">(recordName, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.record_request">module deepstream.io.record_request</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_request.record_request">
            function <span class="apidocSignatureSpan">deepstream.io.</span>record_request
            <span class="apidocSignatureSpan">(recordName, options, socketWrapper, onComplete, onError)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.record_request.prototype">module deepstream.io.record_request.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_request.prototype._destroy">
            function <span class="apidocSignatureSpan">deepstream.io.record_request.prototype.</span>_destroy
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_request.prototype._onCacheResponse">
            function <span class="apidocSignatureSpan">deepstream.io.record_request.prototype.</span>_onCacheResponse
            <span class="apidocSignatureSpan">(error, record)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_request.prototype._onStorageResponse">
            function <span class="apidocSignatureSpan">deepstream.io.record_request.prototype.</span>_onStorageResponse
            <span class="apidocSignatureSpan">(error, record)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_request.prototype._sendError">
            function <span class="apidocSignatureSpan">deepstream.io.record_request.prototype.</span>_sendError
            <span class="apidocSignatureSpan">(event, message)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.record_transition">module deepstream.io.record_transition</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.record_transition">
            function <span class="apidocSignatureSpan">deepstream.io.</span>record_transition
            <span class="apidocSignatureSpan">(name, options, recordHandler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition._getRecordConfig">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.</span>_getRecordConfig
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.record_transition.prototype">module deepstream.io.record_transition.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype._applyConfig">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_applyConfig
            <span class="apidocSignatureSpan">(config, step)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype._flushVersionExists">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_flushVersionExists
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype._next">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_next
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype._onCacheResponse">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_onCacheResponse
            <span class="apidocSignatureSpan">(currentStep, error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype._onFatalError">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_onFatalError
            <span class="apidocSignatureSpan">(errorMessage)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype._onRecord">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_onRecord
            <span class="apidocSignatureSpan">(step, record)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype._onStorageResponse">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_onStorageResponse
            <span class="apidocSignatureSpan">(currentStep, error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype._processRecord">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_processRecord
            <span class="apidocSignatureSpan">(record)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype._sendWriteAcknowledgements">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_sendWriteAcknowledgements
            <span class="apidocSignatureSpan">(errorMessage)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype.add">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>add
            <span class="apidocSignatureSpan">(socketWrapper, version, message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype.destroy">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>destroy
            <span class="apidocSignatureSpan">(errorMessage)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype.hasVersion">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>hasVersion
            <span class="apidocSignatureSpan">(version)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.record_transition.prototype.sendVersionExists">
            function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>sendVersionExists
            <span class="apidocSignatureSpan">(step)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.rule_application">module deepstream.io.rule_application</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.rule_application">
            function <span class="apidocSignatureSpan">deepstream.io.</span>rule_application
            <span class="apidocSignatureSpan">(params)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.rule_application.prototype">module deepstream.io.rule_application.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._createNewRecordRequest">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_createNewRecordRequest
            <span class="apidocSignatureSpan">(recordName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._crossReference">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_crossReference
            <span class="apidocSignatureSpan">(recordName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._destroy">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_destroy
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._getArguments">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getArguments
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._getCurrentData">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getCurrentData
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._getOldData">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getOldData
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._getPathVars">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getPathVars
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._getRecordPatchData">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getRecordPatchData
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._getRecordUpdateData">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getRecordUpdateData
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._getUser">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getUser
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._isReady">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_isReady
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._loadRecord">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_loadRecord
            <span class="apidocSignatureSpan">(recordName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._onLoadComplete">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_onLoadComplete
            <span class="apidocSignatureSpan">(recordName, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._onLoadError">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_onLoadError
            <span class="apidocSignatureSpan">(recordName, error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._onRuleError">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_onRuleError
            <span class="apidocSignatureSpan">(error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_application.prototype._run">
            function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_run
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.rule_cache">module deepstream.io.rule_cache</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_cache.rule_cache">
            function <span class="apidocSignatureSpan">deepstream.io.</span>rule_cache
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.rule_cache.prototype">module deepstream.io.rule_cache.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_cache.prototype._purge">
            function <span class="apidocSignatureSpan">deepstream.io.rule_cache.prototype.</span>_purge
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_cache.prototype._toKey">
            function <span class="apidocSignatureSpan">deepstream.io.rule_cache.prototype.</span>_toKey
            <span class="apidocSignatureSpan">(section, name, type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_cache.prototype.get">
            function <span class="apidocSignatureSpan">deepstream.io.rule_cache.prototype.</span>get
            <span class="apidocSignatureSpan">(section, name, type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_cache.prototype.has">
            function <span class="apidocSignatureSpan">deepstream.io.rule_cache.prototype.</span>has
            <span class="apidocSignatureSpan">(section, name, type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_cache.prototype.reset">
            function <span class="apidocSignatureSpan">deepstream.io.rule_cache.prototype.</span>reset
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_cache.prototype.set">
            function <span class="apidocSignatureSpan">deepstream.io.rule_cache.prototype.</span>set
            <span class="apidocSignatureSpan">(section, name, type, rule)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.rule_parser">module deepstream.io.rule_parser</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_parser.parse">
            function <span class="apidocSignatureSpan">deepstream.io.rule_parser.</span>parse
            <span class="apidocSignatureSpan">(rule, variables)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rule_parser.validate">
            function <span class="apidocSignatureSpan">deepstream.io.rule_parser.</span>validate
            <span class="apidocSignatureSpan">(rule, section, type)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.rules_map">module deepstream.io.rules_map</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rules_map.getRulesForMessage">
            function <span class="apidocSignatureSpan">deepstream.io.rules_map.</span>getRulesForMessage
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rules_map.supportsData">
            function <span class="apidocSignatureSpan">deepstream.io.rules_map.</span>supportsData
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.rules_map.supportsOldData">
            function <span class="apidocSignatureSpan">deepstream.io.rules_map.</span>supportsOldData
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.socket_wrapper">module deepstream.io.socket_wrapper</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.socket_wrapper">
            function <span class="apidocSignatureSpan">deepstream.io.</span>socket_wrapper
            <span class="apidocSignatureSpan">(socket, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.finalizeMessage">
            function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.</span>finalizeMessage
            <span class="apidocSignatureSpan">(preparedMessage)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.prepareMessage">
            function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.</span>prepareMessage
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.super_">
            function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.</span>lastPreparedMessage</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.socket_wrapper.prototype">module deepstream.io.socket_wrapper.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.prototype._onSocketClose">
            function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>_onSocketClose
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.prototype._setUpHandshakeData">
            function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>_setUpHandshakeData
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.prototype.destroy">
            function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>destroy
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.prototype.getHandshakeData">
            function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>getHandshakeData
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.prototype.send">
            function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>send
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.prototype.sendError">
            function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>sendError
            <span class="apidocSignatureSpan">(topic, type, msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.prototype.sendMessage">
            function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>sendMessage
            <span class="apidocSignatureSpan">(topic, action, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.prototype.sendNative">
            function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>sendNative
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.socket_wrapper.prototype.sendPrepared">
            function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>sendPrepared
            <span class="apidocSignatureSpan">(preparedMessage)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.std_out_logger">module deepstream.io.std_out_logger</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.std_out_logger.std_out_logger">
            function <span class="apidocSignatureSpan">deepstream.io.</span>std_out_logger
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.std_out_logger.prototype">module deepstream.io.std_out_logger.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.std_out_logger.prototype.log">
            function <span class="apidocSignatureSpan">deepstream.io.std_out_logger.prototype.</span>log
            <span class="apidocSignatureSpan">(logLevel, event, logMessage)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.std_out_logger.prototype.setLogLevel">
            function <span class="apidocSignatureSpan">deepstream.io.std_out_logger.prototype.</span>setLogLevel
            <span class="apidocSignatureSpan">(logLevel)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.deepstream.io.utils">module deepstream.io.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.combineEvents">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>combineEvents
            <span class="apidocSignatureSpan">(emitters, event, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.deepCopy">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>deepCopy
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.getRandomIntInRange">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>getRandomIntInRange
            <span class="apidocSignatureSpan">(min, max)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.getUid">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>getUid
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.isOfType">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>isOfType
            <span class="apidocSignatureSpan">(input, expectedType)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.merge">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>merge
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.parseJSON">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>parseJSON
            <span class="apidocSignatureSpan">(text, reviver)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.reverseMap">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>reverseMap
            <span class="apidocSignatureSpan">(map)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.setInterval">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>setInterval
            <span class="apidocSignatureSpan">(callback, intervalDuration)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.setTimeout">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>setTimeout
            <span class="apidocSignatureSpan">(callback, timeoutDuration)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.shuffleArray">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>shuffleArray
            <span class="apidocSignatureSpan">(array)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.spliceRandomElement">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>spliceRandomElement
            <span class="apidocSignatureSpan">(array)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.deepstream.io.utils.validateMap">
            function <span class="apidocSignatureSpan">deepstream.io.utils.</span>validateMap
            <span class="apidocSignatureSpan">(map, throwError, schema)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io" id="apidoc.module.deepstream.io">module deepstream.io</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.io" id="apidoc.element.deepstream.io.io">
        function <span class="apidocSignatureSpan">deepstream.</span>io
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io = function (config) {
  this._currentState = STATES.CLOSED
  this.constants = C
  this._loadConfig(config)
  this._connectionEndpoint = null
  this._messageProcessor = null
  this._messageDistributor = null
  this._eventHandler = null
  this._rpcHandler = null
  this._recordHandler = null
  this._plugins = [
    'messageConnector',
    'storage',
    'cache',
    'authenticationHandler',
    'permissionHandler'
  ]
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.io.config_permission_handler" id="apidoc.element.deepstream.io.io.config_permission_handler">
        function <span class="apidocSignatureSpan">deepstream.io.</span>io.config_permission_handler
        <span class="apidocSignatureSpan">(options, config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.config_permission_handler = function (options, config) {
  this._ruleCache = new RuleCache(options)
  this._options = options
  this._permissionOptions = options.permission.options
  this._config = null
  this._recordHandler = null
  this.isReady = false
  this.type = `valve permissions loaded from ${this._permissionOptions.path}`
  this._optionsValid = true

  const maxRuleIterations = options.permission.options.maxRuleIterations
  if (maxRuleIterations !== undefined &amp;&amp; maxRuleIterations &lt; 1) {
    this._optionsValid = false
    process.nextTick(() =&gt; this.emit('error', 'Maximum rule iteration has to be at least one '))
  } else if (config) {
    this.useConfig(config)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.io.dependency_initialiser" id="apidoc.element.deepstream.io.io.dependency_initialiser">
        function <span class="apidocSignatureSpan">deepstream.io.</span>io.dependency_initialiser
        <span class="apidocSignatureSpan">(options, name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.dependency_initialiser = function (options, name) {
  this.isReady = false

  this._options = options
  this._dependency = options[name]
  this._name = name
  this._timeout = null

  if (typeof this._dependency.on !== 'function' &amp;&amp; typeof this._dependency.isReady === 'undefined') {
    const errorMessage = `${this._name} needs to implement isReady or be an emitter`
    this._options.logger.log(C.LOG_LEVEL.ERROR, C.EVENT.PLUGIN_INITIALIZATION_ERROR, errorMessage)
    const error = new Error(errorMessage)
    error.code = 'PLUGIN_INITIALIZATION_ERROR'
    throw error
  }

  if (this._dependency.isReady) {
    this._onReady()
  } else {
    this._timeout = setTimeout(
      this._onTimeout.bind(this),
      this._options.dependencyInitialisationTimeout
    )
    this._dependency.once('ready', this._onReady.bind(this))
    this._dependency.on('error', this._onError.bind(this))

    if (this._dependency.init) {
      this._dependency.init()
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.io.event_handler" id="apidoc.element.deepstream.io.io.event_handler">
        function <span class="apidocSignatureSpan">deepstream.io.</span>io.event_handler
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.event_handler = function (options) {
  this._options = options
  this._subscriptionRegistry = new SubscriptionRegistry(options, C.TOPIC.EVENT)
  this._listenerRegistry = new ListenerRegistry(C.TOPIC.EVENT, options, this._subscriptionRegistry)
  this._subscriptionRegistry.setSubscriptionListener(this._listenerRegistry)
  this._logger = options.logger
  this._message = options.messageConnector
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.io.json_path" id="apidoc.element.deepstream.io.io.json_path">
        function <span class="apidocSignatureSpan">deepstream.io.</span>io.json_path
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.json_path = function (path) {
  this._path = path
  this._tokens = []
  this._tokenize()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.io.record_deletion" id="apidoc.element.deepstream.io.io.record_deletion">
        function <span class="apidocSignatureSpan">deepstream.io.</span>io.record_deletion
        <span class="apidocSignatureSpan">(options, socketWrapper, message, successCallback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.record_deletion = function (options, socketWrapper, message, successCallback) {
  this._options = options
  this._socketWrapper = socketWrapper
  this._message = message
  this._successCallback = successCallback
  this._recordName = message.data[0]
  this._completed = 0
  this._isDestroyed = false

  this._cacheTimeout = setTimeout(
    this._handleError.bind(this, 'cache timeout'),
    this._options.cacheRetrievalTimeout
  )
  this._options.cache.delete(
    this._recordName,
    this._checkIfDone.bind(this, this._cacheTimeout)
  )

  if (!this._options.storageExclusion || !this._options.storageExclusion.test(this._recordName)) {
    this._storageTimeout = setTimeout(
      this._handleError.bind(this, 'storage timeout'),
      this._options.storageRetrievalTimeout
    )
    this._options.storage.delete(
      this._recordName,
      this._checkIfDone.bind(this, this._storageTimeout)
    )
  } else {
    this._checkIfDone(null)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.io.record_handler" id="apidoc.element.deepstream.io.io.record_handler">
        function <span class="apidocSignatureSpan">deepstream.io.</span>io.record_handler
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.record_handler = function (options) {
  this._options = options
  this._subscriptionRegistry = new SubscriptionRegistry(options, C.TOPIC.RECORD)
  this._listenerRegistry = new ListenerRegistry(C.TOPIC.RECORD, options, this._subscriptionRegistry)
  this._subscriptionRegistry.setSubscriptionListener(this._listenerRegistry)
  this._transitions = {}
  this._recordRequestsInProgress = {}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.io.record_request" id="apidoc.element.deepstream.io.io.record_request">
        function <span class="apidocSignatureSpan">deepstream.io.</span>io.record_request
        <span class="apidocSignatureSpan">(recordName, options, socketWrapper, onComplete, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.record_request = function (recordName, options, socketWrapper, onComplete, onError) {
  this._recordName = recordName
  this._options = options
  this._socketWrapper = socketWrapper
  this._storageRetrievalTimeout = null
  this._onComplete = onComplete
  this._onError = onError
  this._isDestroyed = false

  this._cacheRetrievalTimeout = setTimeout(
    this._sendError.bind(this, C.EVENT.CACHE_RETRIEVAL_TIMEOUT, this._recordName),
    this._options.cacheRetrievalTimeout
  )

  this._options.cache.get(this._recordName, this._onCacheResponse.bind(this))
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.io.record_transition" id="apidoc.element.deepstream.io.io.record_transition">
        function <span class="apidocSignatureSpan">deepstream.io.</span>io.record_transition
        <span class="apidocSignatureSpan">(name, options, recordHandler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.record_transition = function (name, options, recordHandler) {
  this._name = name
  this._options = options
  this._recordHandler = recordHandler
  this._steps = []
  this._record = null
  this._currentStep = null
  this._recordRequest = null
  this._sendVersionExists = []
  this.isDestroyed = false
  this._pendingUpdates = {}
  this._ending = false
  this._storageResponses = 0
  this._cacheResponses = 0
  this._lastVersion = null
  this._lastError = null
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.io.rule_application" id="apidoc.element.deepstream.io.io.rule_application">
        function <span class="apidocSignatureSpan">deepstream.io.</span>io.rule_application
        <span class="apidocSignatureSpan">(params)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.rule_application = function (params) {
  this._params = params
  this._isDestroyed = false
  this._runScheduled = false
  this._maxIterationCount = this._params.permissionOptions.maxRuleIterations
  this._crossReferenceFn = this._crossReference.bind(this)
  this._pathVars = this._getPathVars()
  this._user = this._getUser()
  this._recordData = {}
  this._id = Math.random().toString()
  this._iterations = 0
  this._run()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.io.rule_cache" id="apidoc.element.deepstream.io.io.rule_cache">
        function <span class="apidocSignatureSpan">deepstream.io.</span>io.rule_cache
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.rule_cache = function (options) {
  this._options = options
  this._data = {}
  setInterval(this._purge.bind(this), options.cacheEvacuationInterval)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.io.socket_wrapper" id="apidoc.element.deepstream.io.io.socket_wrapper">
        function <span class="apidocSignatureSpan">deepstream.io.</span>io.socket_wrapper
        <span class="apidocSignatureSpan">(socket, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.socket_wrapper = function (socket, options) {
  this.socket = socket
  this.isClosed = false
  this.socket.once('close', this._onSocketClose.bind(this))
  this._options = options
  this.user = null
  this.authCallBack = null
  this.authAttempts = 0
  this.setMaxListeners(0)
  this.uuid = Math.random()
  this._handshakeData = null
  this._setUpHandshakeData()

  this._queuedMessages = []
  this._currentPacketMessageCount = 0
  this._sendNextPacketTimeout = null
  this._currentMessageResetTimeout = null
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.io.std_out_logger" id="apidoc.element.deepstream.io.io.std_out_logger">
        function <span class="apidocSignatureSpan">deepstream.io.</span>io.std_out_logger
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.std_out_logger = function (options) {
  this._options = options || {}
  this.isReady = true
  this._$useColors = this._options.colors === undefined ? true : this._options.colors
  this._logLevelColors = [
    'white',
    'green',
    'yellow',
    'red'
  ]

  this._currentLogLevel = C.LOG_LEVEL[this._options.logLevel] || C.LOG_LEVEL.DEBUG
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.readMessage" id="apidoc.element.deepstream.io.readMessage">
        function <span class="apidocSignatureSpan">deepstream.io.</span>readMessage
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function readMessage(message) {
  const TOPIC = C.TOPIC
  const ACTIONS = C.ACTIONS
  return {
    isRecord: message.topic === TOPIC.RECORD,
    isEvent: message.topic === TOPIC.EVENT,
    isRPC: message.topic === TOPIC.RPC,

    isCreate: message.action === ACTIONS.CREATEORREAD,
    isRead: message.action === ACTIONS.CREATEORREAD,
    isChange: (
      message.action === ACTIONS.PATCH || message.action === ACTIONS.UPDATE
    ),
    isDelete: message.action === ACTIONS.DELETE,

    isAck: message.action === ACTIONS.ACK,
    isSubscribe: message.action === ACTIONS.SUBSCRIBE,
    isUnsubscribe: message.action === ACTIONS.UNSUBSCRIBE,
    isRequest: message.action === ACTIONS.REQUEST,
    isRejection: message.action === ACTIONS.REJECTION,

    name: message.data[0],
    path: message.action === ACTIONS.PATCH ? message.data[2] : undefined,
    data: message.action === ACTIONS.PATCH ? message.data[3] : message.data[2]
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.super_" id="apidoc.element.deepstream.io.super_">
        function <span class="apidocSignatureSpan">deepstream.io.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>
























































</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.config_compiler" id="apidoc.module.deepstream.io.config_compiler">module deepstream.io.config_compiler</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.config_compiler.compile" id="apidoc.element.deepstream.io.config_compiler.compile">
        function <span class="apidocSignatureSpan">deepstream.io.config_compiler.</span>compile
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">compile = function (config) {
  const compiledConfig = {}
  let compiledRuleset
  let section
  let path

  for (section in config) {
    compiledConfig[section] = []

    for (path in config[section]) {
      compiledRuleset = compileRuleset(path, config[section][path])
      compiledConfig[section].push(compiledRuleset)
    }
  }

  return compiledConfig
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 const validationResult = configValidator.validate(config)

 if (validationResult !== true) {
   this.emit('error', `invalid permission config - ${validationResult}`)
   return
 }

 this._config = configCompiler.<span class="apidocCodeKeywordSpan">compile</span>(config)
 this._ruleCache.reset()
 this._ready()
}

/**
* Implements the permissionHandler's canPerformAction interface
* method
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.config_initialiser" id="apidoc.module.deepstream.io.config_initialiser">module deepstream.io.config_initialiser</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.config_initialiser.initialise" id="apidoc.element.deepstream.io.config_initialiser.initialise">
        function <span class="apidocSignatureSpan">deepstream.io.config_initialiser.</span>initialise
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">initialise = function (config) {
  commandLineArguments = global.deepstreamCLI || {}

  handleUUIDProperty(config)
  handleSSLProperties(config)
  handleLogger(config)
  handlePlugins(config)
  handleAuthStrategy(config)
  handlePermissionStrategy(config)

  return config
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 *
 * @public
 * @returns {Object} config deepstream configuration object
 */
module.exports.loadConfig = function (filePath, /* test only */ args) {
  const config = exports.loadConfigWithoutInitialisation(filePath, args)
  return {
    config: configInitialiser.<span class="apidocCodeKeywordSpan">initialise</span>(config.config),
    file: config.configPath
  }
}

/**
* Set the globalConfig prefix that will be used as the directory for ssl, permissions and auth
* relative files within the config file
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.config_permission_handler" id="apidoc.module.deepstream.io.config_permission_handler">module deepstream.io.config_permission_handler</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.config_permission_handler.config_permission_handler" id="apidoc.element.deepstream.io.config_permission_handler.config_permission_handler">
        function <span class="apidocSignatureSpan">deepstream.io.</span>config_permission_handler
        <span class="apidocSignatureSpan">(options, config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">config_permission_handler = function (options, config) {
  this._ruleCache = new RuleCache(options)
  this._options = options
  this._permissionOptions = options.permission.options
  this._config = null
  this._recordHandler = null
  this.isReady = false
  this.type = `valve permissions loaded from ${this._permissionOptions.path}`
  this._optionsValid = true

  const maxRuleIterations = options.permission.options.maxRuleIterations
  if (maxRuleIterations !== undefined &amp;&amp; maxRuleIterations &lt; 1) {
    this._optionsValid = false
    process.nextTick(() =&gt; this.emit('error', 'Maximum rule iteration has to be at least one '))
  } else if (config) {
    this.useConfig(config)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.config_permission_handler.super_" id="apidoc.element.deepstream.io.config_permission_handler.super_">
        function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.config_permission_handler.prototype" id="apidoc.module.deepstream.io.config_permission_handler.prototype">module deepstream.io.config_permission_handler.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.config_permission_handler.prototype._getCompiledRulesForName" id="apidoc.element.deepstream.io.config_permission_handler.prototype._getCompiledRulesForName">
        function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>_getCompiledRulesForName
        <span class="apidocSignatureSpan">(name, ruleSpecification)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getCompiledRulesForName = function (name, ruleSpecification) {
  if (this._ruleCache.has(ruleSpecification.section, name, ruleSpecification.type)) {
    return this._ruleCache.get(ruleSpecification.section, name, ruleSpecification.type)
  }

  const section = this._config[ruleSpecification.section]
  let i = 0
  let pathLength = 0
  let result = null

  for (i; i &lt; section.length; i++) {
    if (
      typeof section[i].rules[ruleSpecification.type] !== UNDEFINED &amp;&amp;
      section[i].path.length &gt;= pathLength &amp;&amp;
      section[i].regexp.test(name)
    ) {
      pathLength = section[i].path.length
      result = {
        path: section[i].path,
        regexp: section[i].regexp,
        rule: section[i].rules[ruleSpecification.type]
      }
    }
  }

  if (result) {
    this._ruleCache.set(ruleSpecification.section, name, ruleSpecification.type, result)
  }

  return result
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
const name = message.data[0]

if (ruleSpecification === null) {
  callback(null, true)
  return
}

const ruleData = this.<span class="apidocCodeKeywordSpan">_getCompiledRulesForName</span>(name, ruleSpecification)

// eslint-disable-next-line
new RuleApplication({
  recordHandler: this._recordHandler,
  username,
  authData,
  path: ruleData,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.config_permission_handler.prototype._onConfigLoaded" id="apidoc.element.deepstream.io.config_permission_handler.prototype._onConfigLoaded">
        function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>_onConfigLoaded
        <span class="apidocSignatureSpan">(filePath, loadError, config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onConfigLoaded = function (filePath, loadError, config) {
  if (loadError) {
    this.emit('error', `error while loading config: ${loadError.toString()}`)
    return
  }
  this.emit('config-loaded', filePath)
  this.useConfig(config)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.config_permission_handler.prototype._ready" id="apidoc.element.deepstream.io.config_permission_handler.prototype._ready">
        function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>_ready
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_ready = function () {
  if (this.isReady === false) {
    this.isReady = true
    this.emit('ready')
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 if (validationResult !== true) {
   this.emit('error', `invalid permission config - ${validationResult}`)
   return
 }

 this._config = configCompiler.compile(config)
 this._ruleCache.reset()
 this.<span class="apidocCodeKeywordSpan">_ready</span>()
}

/**
* Implements the permissionHandler's canPerformAction interface
* method
*
* This is the main entry point for permissionOperations and will
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.config_permission_handler.prototype.canPerformAction" id="apidoc.element.deepstream.io.config_permission_handler.prototype.canPerformAction">
        function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>canPerformAction
        <span class="apidocSignatureSpan">( username, message, callback, authData)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">canPerformAction = function ( username, message, callback, authData) {
  if (typeof message.data[0] !== STRING) {
    callback('invalid message', false)
    return
  }

  const ruleSpecification = rulesMap.getRulesForMessage(message)
  const name = message.data[0]

  if (ruleSpecification === null) {
    callback(null, true)
    return
  }

  const ruleData = this._getCompiledRulesForName(name, ruleSpecification)

  // eslint-disable-next-line
  new RuleApplication({
    recordHandler: this._recordHandler,
    username,
    authData,
    path: ruleData,
    ruleSpecification,
    message,
    action: ruleSpecification.action,
    regexp: ruleData.regexp,
    rule: ruleData.rule,
    name,
    callback,
    logger: this._options.logger,
    permissionOptions: this._permissionOptions,
    options: this._options
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      continue
    }

    if (parsedMessage.topic === C.TOPIC.CONNECTION &amp;&amp; parsedMessage.action === C.ACTIONS.PONG) {
      continue
    }

    this._options.permissionHandler.<span class="apidocCodeKeywordSpan">canPerformAction</span>(
      socketWrapper.user,
      parsedMessage,
      this._onPermissionResponse.bind(this, socketWrapper, parsedMessage),
      socketWrapper.authData
    )
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.config_permission_handler.prototype.init" id="apidoc.element.deepstream.io.config_permission_handler.prototype.init">
        function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>init
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function () {
  if (this._config === null &amp;&amp; this._optionsValid) {
    this.loadConfig(this._permissionOptions.path)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      this._onTimeout.bind(this),
      this._options.dependencyInitialisationTimeout
    )
    this._dependency.once('ready', this._onReady.bind(this))
    this._dependency.on('error', this._onError.bind(this))

    if (this._dependency.init) {
      this._dependency.<span class="apidocCodeKeywordSpan">init</span>()
    }
  }
}

utils.inherits(DependencyInitialiser, EventEmitter)

/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.config_permission_handler.prototype.loadConfig" id="apidoc.element.deepstream.io.config_permission_handler.prototype.loadConfig">
        function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>loadConfig
        <span class="apidocSignatureSpan">(filePath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">loadConfig = function (filePath) {
  jsYamlLoader.readAndParseFile(filePath, this._onConfigLoaded.bind(this, filePath))
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* first
*
* @public
* @returns {void}
*/
ConfigPermissionHandler.prototype.init = function () {
 if (this._config === null &amp;&amp; this._optionsValid) {
   this.<span class="apidocCodeKeywordSpan">loadConfig</span>(this._permissionOptions.path)
 }
}

/**
* Load a configuration file. This will either load a configuration file for the first time at
* startup or reload the configuration at runtime
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.config_permission_handler.prototype.setRecordHandler" id="apidoc.element.deepstream.io.config_permission_handler.prototype.setRecordHandler">
        function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>setRecordHandler
        <span class="apidocSignatureSpan">(recordHandler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setRecordHandler = function (recordHandler) {
  this._recordHandler = recordHandler
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.config_permission_handler.prototype.useConfig" id="apidoc.element.deepstream.io.config_permission_handler.prototype.useConfig">
        function <span class="apidocSignatureSpan">deepstream.io.config_permission_handler.prototype.</span>useConfig
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">useConfig = function (config) {
  const validationResult = configValidator.validate(config)

  if (validationResult !== true) {
    this.emit('error', `invalid permission config - ${validationResult}`)
    return
  }

  this._config = configCompiler.compile(config)
  this._ruleCache.reset()
  this._ready()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 this._optionsValid = true

 const maxRuleIterations = options.permission.options.maxRuleIterations
 if (maxRuleIterations !== undefined &amp;&amp; maxRuleIterations &lt; 1) {
   this._optionsValid = false
   process.nextTick(() =&gt; this.emit('error', 'Maximum rule iteration has to be at least one '))
 } else if (config) {
   this.<span class="apidocCodeKeywordSpan">useConfig</span>(config)
 }
}

utils.inherits(ConfigPermissionHandler, events.EventEmitter)

/**
* Will be invoked with the initialised recordHandler instance by deepstream.io
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.config_validator" id="apidoc.module.deepstream.io.config_validator">module deepstream.io.config_validator</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.config_validator.validate" id="apidoc.element.deepstream.io.config_validator.validate">
        function <span class="apidocSignatureSpan">deepstream.io.config_validator.</span>validate
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validate = function (config) {
  let validationStepResult
  let key

  for (key in validationSteps) {
    validationStepResult = validationSteps[key](config)

    if (validationStepResult !== true) {
      return validationStepResult
    }
  }

  return true
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 *
 * @param   {Object} config deepstream permissionConfig
 *
 * @public
 * @returns {void}
 */
ConfigPermissionHandler.prototype.useConfig = function (config) {
const validationResult = configValidator.<span class="apidocCodeKeywordSpan">validate</span>(config)

if (validationResult !== true) {
  this.emit('error', `invalid permission config - ${validationResult}`)
  return
}

this._config = configCompiler.compile(config)
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.default_options" id="apidoc.module.deepstream.io.default_options">module deepstream.io.default_options</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.default_options.get" id="apidoc.element.deepstream.io.default_options.get">
        function <span class="apidocSignatureSpan">deepstream.io.default_options.</span>get
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function () {
  const options = {
<span class="apidocCodeCommentSpan">    /*
    * General
    */
</span>    serverName: utils.getUid(),
    showLogo: true,
    logLevel: C.LOG_LEVEL.INFO,

    /*
    * Connectivity
    */
    port: 6020,
    host: '0.0.0.0',
    urlPath: '/deepstream',
    healthCheckPath: '/health-check',
    externalUrl: null,
    heartbeatInterval: 30000,

    /*
    * SSL Configuration
    */
    sslKey: null,
    sslCert: null,
    sslCa: null,

    /*
    * Authentication
    */
    auth: {
      type: 'none'
    },

    /*
    * Permissioning
    */
    permission: {
      type: 'none'
    },

    /*
    * Default Plugins
    */
    messageConnector: require('./default-plugins/noop-message-connector'),
    cache: require('./default-plugins/local-cache'),
    storage: require('./default-plugins/noop-storage'),

    /*
    * Storage options
    */
    storageExclusion: null,

    /*
    * Security
    */
    unauthenticatedClientTimeout: 180000,
    maxAuthAttempts: 3,
    logInvalidAuthData: true,
    maxMessageSize: 1048576,

    /**
     * Listening
     */
    shuffleListenProviders: true,

    /*
    * Timeouts
    */
    rpcAckTimeout: 1000,
    rpcTimeout: 10000,
    cacheRetrievalTimeout: 1000,
    storageRetrievalTimeout: 2000,
    dependencyInitialisationTimeout: 2000,
    stateReconciliationTimeout: 500,
    clusterKeepAliveInterval: 5000,
    clusterActiveCheckInterval: 1000,
    clusterNodeInactiveTimeout: 6000,
    listenResponseTimeout: 500,
    lockTimeout: 1000,
    lockRequestTimeout: 1000,
    broadcastTimeout: 0
  }

  return options
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 *
 * @param  {String}   urlPath URL where to download the archive
 * @param  {Stream}   writeable output stream to save the archive
 * @param  {Function} callback Callback (err)
 * @return {void}
 */
const downloadArchive = function (urlPath, outStream, callback) {
needle.<span class="apidocCodeKeywordSpan">get</span>(`https://github.com${urlPath}`, {
  follow_max: 5,
  headers: { 'User-Agent': 'nodejs-client' }
}, (error, response) =&gt; {
  if (error) {
    return callback(error)
  }
  outStream.write(response.body)
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.dependency_initialiser" id="apidoc.module.deepstream.io.dependency_initialiser">module deepstream.io.dependency_initialiser</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.dependency_initialiser.dependency_initialiser" id="apidoc.element.deepstream.io.dependency_initialiser.dependency_initialiser">
        function <span class="apidocSignatureSpan">deepstream.io.</span>dependency_initialiser
        <span class="apidocSignatureSpan">(options, name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dependency_initialiser = function (options, name) {
  this.isReady = false

  this._options = options
  this._dependency = options[name]
  this._name = name
  this._timeout = null

  if (typeof this._dependency.on !== 'function' &amp;&amp; typeof this._dependency.isReady === 'undefined') {
    const errorMessage = `${this._name} needs to implement isReady or be an emitter`
    this._options.logger.log(C.LOG_LEVEL.ERROR, C.EVENT.PLUGIN_INITIALIZATION_ERROR, errorMessage)
    const error = new Error(errorMessage)
    error.code = 'PLUGIN_INITIALIZATION_ERROR'
    throw error
  }

  if (this._dependency.isReady) {
    this._onReady()
  } else {
    this._timeout = setTimeout(
      this._onTimeout.bind(this),
      this._options.dependencyInitialisationTimeout
    )
    this._dependency.once('ready', this._onReady.bind(this))
    this._dependency.on('error', this._onError.bind(this))

    if (this._dependency.init) {
      this._dependency.init()
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.dependency_initialiser.super_" id="apidoc.element.deepstream.io.dependency_initialiser.super_">
        function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.dependency_initialiser.prototype" id="apidoc.module.deepstream.io.dependency_initialiser.prototype">module deepstream.io.dependency_initialiser.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.dependency_initialiser.prototype._emitReady" id="apidoc.element.deepstream.io.dependency_initialiser.prototype._emitReady">
        function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.prototype.</span>_emitReady
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_emitReady = function () {
  this.isReady = true
  this.emit('ready')
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.dependency_initialiser.prototype._logError" id="apidoc.element.deepstream.io.dependency_initialiser.prototype._logError">
        function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.prototype.</span>_logError
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_logError = function (message) {
  if (this._options.logger &amp;&amp; this._options.logger.isReady) {
    this._options.logger.log(C.LOG_LEVEL.ERROR, C.EVENT.PLUGIN_ERROR, message)
  } else {
    console.error('Error while initialising dependency')
    console.error(message)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Callback for dependencies that weren't initialised in time
 *
 * @private
 * @returns {void}
 */
DependencyInitialiser.prototype._onTimeout = function () {
  const message = `${this._name} wasn't initialised in time`
  this.<span class="apidocCodeKeywordSpan">_logError</span>(message)
  const error = new Error(message)
  error.code = C.EVENT.PLUGIN_INITIALIZATION_TIMEOUT
  throw error
}

/**
* Handles errors emitted by the dependency at startup.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.dependency_initialiser.prototype._onError" id="apidoc.element.deepstream.io.dependency_initialiser.prototype._onError">
        function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.prototype.</span>_onError
        <span class="apidocSignatureSpan">(error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onError = function (error) {
  if (this.isReady !== true) {
    this._logError(`Error while initialising ${this._name}: ${error.toString()}`)
    error.code = C.EVENT.PLUGIN_INITIALIZATION_ERROR
    throw error
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
RecordRequest.prototype._sendError = function (event, message) {
 this._options.logger.log(C.LOG_LEVEL.ERROR, event, message)
 if (this._socketWrapper) {
   this._socketWrapper.sendError(C.TOPIC.RECORD, event, message)
 }
 if (this._onError) {
   this.<span class="apidocCodeKeywordSpan">_onError</span>(event, message)
 }
 this._destroy()
}

/**
* Destroys the record request. Clears down all references and stops
* all pending timeouts
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.dependency_initialiser.prototype._onReady" id="apidoc.element.deepstream.io.dependency_initialiser.prototype._onReady">
        function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.prototype.</span>_onReady
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onReady = function () {
  if (this._timeout) {
    clearTimeout(this._timeout)
  }

  const dependencyType = this._dependency.type ? `: ${this._dependency.type}` : ''
  this._options.logger.log(C.LOG_LEVEL.INFO, C.EVENT.INFO, `${this._name} ready${dependencyType}`)
  process.nextTick(this._emitReady.bind(this))
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this._options.logger.log(C.LOG_LEVEL.ERROR, C.EVENT.PLUGIN_INITIALIZATION_ERROR, errorMessage)
  const error = new Error(errorMessage)
  error.code = 'PLUGIN_INITIALIZATION_ERROR'
  throw error
}

if (this._dependency.isReady) {
  this.<span class="apidocCodeKeywordSpan">_onReady</span>()
} else {
  this._timeout = setTimeout(
    this._onTimeout.bind(this),
    this._options.dependencyInitialisationTimeout
  )
  this._dependency.once('ready', this._onReady.bind(this))
  this._dependency.on('error', this._onError.bind(this))
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.dependency_initialiser.prototype._onTimeout" id="apidoc.element.deepstream.io.dependency_initialiser.prototype._onTimeout">
        function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.prototype.</span>_onTimeout
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onTimeout = function () {
  const message = `${this._name} wasn't initialised in time`
  this._logError(message)
  const error = new Error(message)
  error.code = C.EVENT.PLUGIN_INITIALIZATION_TIMEOUT
  throw error
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.dependency_initialiser.prototype.getDependency" id="apidoc.element.deepstream.io.dependency_initialiser.prototype.getDependency">
        function <span class="apidocSignatureSpan">deepstream.io.dependency_initialiser.prototype.</span>getDependency
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getDependency = function () {
  return this._dependency
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.event_handler" id="apidoc.module.deepstream.io.event_handler">module deepstream.io.event_handler</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.event_handler.event_handler" id="apidoc.element.deepstream.io.event_handler.event_handler">
        function <span class="apidocSignatureSpan">deepstream.io.</span>event_handler
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">event_handler = function (options) {
  this._options = options
  this._subscriptionRegistry = new SubscriptionRegistry(options, C.TOPIC.EVENT)
  this._listenerRegistry = new ListenerRegistry(C.TOPIC.EVENT, options, this._subscriptionRegistry)
  this._subscriptionRegistry.setSubscriptionListener(this._listenerRegistry)
  this._logger = options.logger
  this._message = options.messageConnector
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.event_handler.prototype" id="apidoc.module.deepstream.io.event_handler.prototype">module deepstream.io.event_handler.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.event_handler.prototype._addSubscriber" id="apidoc.element.deepstream.io.event_handler.prototype._addSubscriber">
        function <span class="apidocSignatureSpan">deepstream.io.event_handler.prototype.</span>_addSubscriber
        <span class="apidocSignatureSpan">(socket, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_addSubscriber = function (socket, message) {
  if (validateSubscriptionMessage(socket, message)) {
    this._subscriptionRegistry.subscribe(message.data[0], socket)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param {Object} message parsed and permissioned deepstream message
 *
 * @public
 * @returns {void}
 */
EventHandler.prototype.handle = function (socket, message) {
if (message.action === C.ACTIONS.SUBSCRIBE) {
  this.<span class="apidocCodeKeywordSpan">_addSubscriber</span>(socket, message)
} else if (message.action === C.ACTIONS.UNSUBSCRIBE) {
  this._removeSubscriber(socket, message)
} else if (message.action === C.ACTIONS.EVENT) {
  this._triggerEvent(socket, message)
} else if (message.action === C.ACTIONS.LISTEN ||
  message.action === C.ACTIONS.UNLISTEN ||
  message.action === C.ACTIONS.LISTEN_ACCEPT ||
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.event_handler.prototype._removeSubscriber" id="apidoc.element.deepstream.io.event_handler.prototype._removeSubscriber">
        function <span class="apidocSignatureSpan">deepstream.io.event_handler.prototype.</span>_removeSubscriber
        <span class="apidocSignatureSpan">(socket, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_removeSubscriber = function (socket, message) {
  if (validateSubscriptionMessage(socket, message)) {
    this._subscriptionRegistry.unsubscribe(message.data[0], socket)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @public
 * @returns {void}
 */
EventHandler.prototype.handle = function (socket, message) {
if (message.action === C.ACTIONS.SUBSCRIBE) {
  this._addSubscriber(socket, message)
} else if (message.action === C.ACTIONS.UNSUBSCRIBE) {
  this.<span class="apidocCodeKeywordSpan">_removeSubscriber</span>(socket, message)
} else if (message.action === C.ACTIONS.EVENT) {
  this._triggerEvent(socket, message)
} else if (message.action === C.ACTIONS.LISTEN ||
  message.action === C.ACTIONS.UNLISTEN ||
  message.action === C.ACTIONS.LISTEN_ACCEPT ||
  message.action === C.ACTIONS.LISTEN_REJECT) {
  this._listenerRegistry.handle(socket, message)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.event_handler.prototype._sendError" id="apidoc.element.deepstream.io.event_handler.prototype._sendError">
        function <span class="apidocSignatureSpan">deepstream.io.event_handler.prototype.</span>_sendError
        <span class="apidocSignatureSpan">(socket, event, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_sendError = function (socket, event, message) {
  if (socket &amp;&amp; socket.sendError) {
    socket.sendError(C.TOPIC.EVENT, event, message)
  }
  this._logger.log(C.LOG_LEVEL.ERROR, event, message)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   this._triggerEvent(socket, message)
 } else if (message.action === C.ACTIONS.LISTEN ||
   message.action === C.ACTIONS.UNLISTEN ||
   message.action === C.ACTIONS.LISTEN_ACCEPT ||
   message.action === C.ACTIONS.LISTEN_REJECT) {
   this._listenerRegistry.handle(socket, message)
 } else {
   this.<span class="apidocCodeKeywordSpan">_sendError</span>(socket, C.EVENT.UNKNOWN_ACTION, `unknown action ${message.action}`)
 }
}

/**
* Handler for the SUBSCRIBE action. Adds the socket as
* a subscriber to the specified event name
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.event_handler.prototype._triggerEvent" id="apidoc.element.deepstream.io.event_handler.prototype._triggerEvent">
        function <span class="apidocSignatureSpan">deepstream.io.event_handler.prototype.</span>_triggerEvent
        <span class="apidocSignatureSpan">(socket, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_triggerEvent = function (socket, message) {
  if (typeof message.data[0] !== 'string') {
    this._sendError(socket, C.EVENT.INVALID_MESSAGE_DATA, message.raw)
    return
  }

  this._logger.log(C.LOG_LEVEL.DEBUG, C.EVENT.TRIGGER_EVENT, message.raw)

  if (socket !== C.SOURCE_MESSAGE_CONNECTOR) {
    this._message.publish(C.TOPIC.EVENT, message)
  }

  this._subscriptionRegistry.sendToSubscribers(
    message.data[0],
    messageBuilder.getMsg(C.TOPIC.EVENT, C.ACTIONS.EVENT, message.data),
    false,
    socket
  )
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
EventHandler.prototype.handle = function (socket, message) {
if (message.action === C.ACTIONS.SUBSCRIBE) {
  this._addSubscriber(socket, message)
} else if (message.action === C.ACTIONS.UNSUBSCRIBE) {
  this._removeSubscriber(socket, message)
} else if (message.action === C.ACTIONS.EVENT) {
  this.<span class="apidocCodeKeywordSpan">_triggerEvent</span>(socket, message)
} else if (message.action === C.ACTIONS.LISTEN ||
  message.action === C.ACTIONS.UNLISTEN ||
  message.action === C.ACTIONS.LISTEN_ACCEPT ||
  message.action === C.ACTIONS.LISTEN_REJECT) {
  this._listenerRegistry.handle(socket, message)
} else {
  this._sendError(socket, C.EVENT.UNKNOWN_ACTION, `unknown action ${message.action}`)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.event_handler.prototype.handle" id="apidoc.element.deepstream.io.event_handler.prototype.handle">
        function <span class="apidocSignatureSpan">deepstream.io.event_handler.prototype.</span>handle
        <span class="apidocSignatureSpan">(socket, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handle = function (socket, message) {
  if (message.action === C.ACTIONS.SUBSCRIBE) {
    this._addSubscriber(socket, message)
  } else if (message.action === C.ACTIONS.UNSUBSCRIBE) {
    this._removeSubscriber(socket, message)
  } else if (message.action === C.ACTIONS.EVENT) {
    this._triggerEvent(socket, message)
  } else if (message.action === C.ACTIONS.LISTEN ||
    message.action === C.ACTIONS.UNLISTEN ||
    message.action === C.ACTIONS.LISTEN_ACCEPT ||
    message.action === C.ACTIONS.LISTEN_REJECT) {
    this._listenerRegistry.handle(socket, message)
  } else {
    this._sendError(socket, C.EVENT.UNKNOWN_ACTION, `unknown action ${message.action}`)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   this._removeSubscriber(socket, message)
 } else if (message.action === C.ACTIONS.EVENT) {
   this._triggerEvent(socket, message)
 } else if (message.action === C.ACTIONS.LISTEN ||
   message.action === C.ACTIONS.UNLISTEN ||
   message.action === C.ACTIONS.LISTEN_ACCEPT ||
   message.action === C.ACTIONS.LISTEN_REJECT) {
   this._listenerRegistry.<span class="apidocCodeKeywordSpan">handle</span>(socket, message)
 } else {
   this._sendError(socket, C.EVENT.UNKNOWN_ACTION, `unknown action ${message.action}`)
 }
}

/**
* Handler for the SUBSCRIBE action. Adds the socket as
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.file_utils" id="apidoc.module.deepstream.io.file_utils">module deepstream.io.file_utils</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.file_utils.fileExistsSync" id="apidoc.element.deepstream.io.file_utils.fileExistsSync">
        function <span class="apidocSignatureSpan">deepstream.io.file_utils.</span>fileExistsSync
        <span class="apidocSignatureSpan">(filePath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fileExistsSync = function (filePath) {
  try {
    fs.lstatSync(filePath)
    return true
  } catch (e) {
    return false
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 *
 * @param   {String} configPath the path to the config file
 *
 * @private
 * @returns {String} verified path
 */
function verifyCustomConfigPath (configPath) {
  if (fileUtils.<span class="apidocCodeKeywordSpan">fileExistsSync</span>(configPath)) {
    return configPath
  }

  throw new Error(`Configuration file not found at: ${configPath}`)
}

/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.file_utils.lookupConfRequirePath" id="apidoc.element.deepstream.io.file_utils.lookupConfRequirePath">
        function <span class="apidocSignatureSpan">deepstream.io.file_utils.</span>lookupConfRequirePath
        <span class="apidocSignatureSpan">(filePath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">lookupConfRequirePath = function (filePath) {
  return exports.lookupRequirePath(filePath, global.deepstreamConfDir)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  let filePath
  for (let i = 0; i &lt; sslFiles.length; i++) {
    key = sslFiles[i]
    filePath = config[key]
    if (!filePath) {
      continue
    }
    resolvedFilePath = fileUtils.<span class="apidocCodeKeywordSpan">lookupConfRequirePath</span>(filePath)
    try {
      config[key] = fs.readFileSync(resolvedFilePath, 'utf8')
    } catch (e) {
      throw new Error(`The file path "${resolvedFilePath}" provided by "${key}" does not exist.`)
    }
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.file_utils.lookupLibRequirePath" id="apidoc.element.deepstream.io.file_utils.lookupLibRequirePath">
        function <span class="apidocSignatureSpan">deepstream.io.file_utils.</span>lookupLibRequirePath
        <span class="apidocSignatureSpan">(filePath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">lookupLibRequirePath = function (filePath) {
  return exports.lookupRequirePath(filePath, global.deepstreamLibDir)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
function resolvePluginClass (plugin, type) {
// nexe needs *global.require* for __dynamic__ modules
// but browserify and proxyquire can't handle *global.require*
const req = global &amp;&amp; global.require ? global.require : require
let requirePath
let pluginConstructor
if (plugin.path != null) {
  requirePath = fileUtils.<span class="apidocCodeKeywordSpan">lookupLibRequirePath</span>(plugin.path)
  pluginConstructor = req(requirePath)
} else if (plugin.name != null) {
  if (type != null) {
    requirePath = `deepstream.io-${type}-${plugin.name}`
    requirePath = fileUtils.lookupLibRequirePath(requirePath)
    pluginConstructor = req(requirePath)
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.file_utils.lookupRequirePath" id="apidoc.element.deepstream.io.file_utils.lookupRequirePath">
        function <span class="apidocSignatureSpan">deepstream.io.file_utils.</span>lookupRequirePath
        <span class="apidocSignatureSpan">(filePath, prefix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">lookupRequirePath = function (filePath, prefix) {
  // filePath is absolute
  if (path.parse(filePath).root !== '') {
    return filePath
  }

  // filePath is not relative (and not absolute)
  if (filePath[0] !== '.') {
    if (prefix == null) {
      return filePath
    }
    return resolvePrefixAndFile(filePath, prefix)
  }

  // filePath is relative, starts with .
  if (prefix == null) {
    return path.resolve(process.cwd(), filePath)
  }
  return resolvePrefixAndFile(filePath, prefix)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* @param {String} filePath
*
* @private
* @returns {String} file path with the library prefix used
*/
exports.lookupLibRequirePath = function (filePath) {
  return exports.<span class="apidocCodeKeywordSpan">lookupRequirePath</span>(filePath, global.deepstreamLibDir)
}

/**
* Append the global configuration directory as the prefix to any path
* used here
*
* @param {String} filePath
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.js_yaml_loader" id="apidoc.module.deepstream.io.js_yaml_loader">module deepstream.io.js_yaml_loader</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.js_yaml_loader.loadConfig" id="apidoc.element.deepstream.io.js_yaml_loader.loadConfig">
        function <span class="apidocSignatureSpan">deepstream.io.js_yaml_loader.</span>loadConfig
        <span class="apidocSignatureSpan">(filePath, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">loadConfig = function (filePath, args) {
  const config = exports.loadConfigWithoutInitialisation(filePath, args)
  return {
    config: configInitialiser.initialise(config.config),
    file: config.configPath
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* first
*
* @public
* @returns {void}
*/
ConfigPermissionHandler.prototype.init = function () {
 if (this._config === null &amp;&amp; this._optionsValid) {
   this.<span class="apidocCodeKeywordSpan">loadConfig</span>(this._permissionOptions.path)
 }
}

/**
* Load a configuration file. This will either load a configuration file for the first time at
* startup or reload the configuration at runtime
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.js_yaml_loader.loadConfigWithoutInitialisation" id="apidoc.element.deepstream.io.js_yaml_loader.loadConfigWithoutInitialisation">
        function <span class="apidocSignatureSpan">deepstream.io.js_yaml_loader.</span>loadConfigWithoutInitialisation
        <span class="apidocSignatureSpan">(filePath, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">loadConfigWithoutInitialisation = function (filePath, args) {
  const argv = args || global.deepstreamCLI || {}
  const configPath = setGlobalConfigDirectory(argv, filePath)
  const configString = fs.readFileSync(configPath, { encoding: 'utf8' })
  const rawConfig = parseFile(configPath, configString)
  const config = extendConfig(rawConfig, argv)
  setGlobalLibDirectory(argv, config)
  return {
    config,
    configPath
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		.description('Generate a hash from a plaintext password using file auth configuration settings')
		.option('-c, --config [file]', 'configuration file containing file auth and hash settings')
		.action(hash)
}

function hash(password) {
global.deepstreamCLI = this
const config = jsYamlLoader.<span class="apidocCodeKeywordSpan">loadConfigWithoutInitialisation</span>().config

if (config.auth.type !== 'file') {
  console.error('Error: Can only use hash with file authentication as auth type')
  process.exit(1)
}

if (!config.auth.options.hash) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.js_yaml_loader.readAndParseFile" id="apidoc.element.deepstream.io.js_yaml_loader.readAndParseFile">
        function <span class="apidocSignatureSpan">deepstream.io.js_yaml_loader.</span>readAndParseFile
        <span class="apidocSignatureSpan">(filePath, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">readAndParseFile = function (filePath, callback) {
  try {
    fs.readFile(filePath, 'utf8', (error, fileContent) =&gt; {
      if (error) {
        return callback(error)
      }

      try {
        const config = parseFile(filePath, fileContent)
        return callback(null, config)
      } catch (parseError) {
        return callback(parseError)
      }
    })
  } catch (error) {
    callback(error)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
constructor (settings) {
  super()
  this.isReady = false
  this.type = `file using ${settings.path}`
  this._validateSettings(settings)
  this._settings = settings
  this._base64KeyLength = 4 * Math.ceil(this._settings.keyLength / 3)
  jsYamlLoader.<span class="apidocCodeKeywordSpan">readAndParseFile</span>(settings.path, this._onFileLoad.bind(this))
}

/**
* Main interface. Authenticates incoming connections
*
* @param   {Object}   connectionData
* @param   {Object}   authData
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.json_path" id="apidoc.module.deepstream.io.json_path">module deepstream.io.json_path</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.json_path.json_path" id="apidoc.element.deepstream.io.json_path.json_path">
        function <span class="apidocSignatureSpan">deepstream.io.</span>json_path
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">json_path = function (path) {
  this._path = path
  this._tokens = []
  this._tokenize()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.json_path.prototype" id="apidoc.module.deepstream.io.json_path.prototype">module deepstream.io.json_path.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.json_path.prototype._tokenize" id="apidoc.element.deepstream.io.json_path.prototype._tokenize">
        function <span class="apidocSignatureSpan">deepstream.io.json_path.prototype.</span>_tokenize
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_tokenize = function () {
  const parts = this._path.split(SPLIT_REG_EXP)
  let part
  let i

  for (i = 0; i &lt; parts.length; i++) {
    part = parts[i].trim()

    if (part.length === 0) {
      continue
    }

    if (!isNaN(part)) {
      this._tokens.push(parseInt(part, 10))
      continue
    }

    this._tokens.push(part)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param {String} path A path, e.g. users[2].firstname
*
* @constructor
*/
const JsonPath = function (path) {
 this._path = path
 this._tokens = []
 this.<span class="apidocCodeKeywordSpan">_tokenize</span>()
}

/**
* Sets the value of the path. If the path (or parts
* of it) doesn't exist yet, it will be created
*
* @param {Object} node
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.json_path.prototype.setValue" id="apidoc.element.deepstream.io.json_path.prototype.setValue">
        function <span class="apidocSignatureSpan">deepstream.io.json_path.prototype.</span>setValue
        <span class="apidocSignatureSpan">(node, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setValue = function (node, value) {
  let i = 0

  for (i = 0; i &lt; this._tokens.length - 1; i++) {
    if (node[this._tokens[i]] !== undefined) {
      node = node[this._tokens[i]]
    } else if (this._tokens[i + 1] &amp;&amp; !isNaN(this._tokens[i + 1])) {
      node = node[this._tokens[i]] = []
    } else {
      node = node[this._tokens[i]] = {}
    }
  }

  node[this._tokens[i]] = value
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 if (currentData === null) {
   return new Error(`Tried to apply patch to non-existant record ${msg.data[0]}`)
 }

 if (typeof currentData !== UNDEFINED &amp;&amp; currentData !== LOADING) {
   jsonPath = new JsonPath(msg.data[2])
   data = JSON.parse(JSON.stringify(currentData._d))
   jsonPath.<span class="apidocCodeKeywordSpan">setValue</span>(data, newData)
   return data
 }
 this._loadRecord(this._params.name)
}

/**
* Returns or loads the record's previous value. Only supported for record
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.message_builder" id="apidoc.module.deepstream.io.message_builder">module deepstream.io.message_builder</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.message_builder.getErrorMsg" id="apidoc.element.deepstream.io.message_builder.getErrorMsg">
        function <span class="apidocSignatureSpan">deepstream.io.message_builder.</span>getErrorMsg
        <span class="apidocSignatureSpan">(topic, type, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getErrorMsg = function (topic, type, message) {
  if (message instanceof Array) {
    return `${topic + SEP}E${SEP}${type}${SEP}${message.join(SEP)}${C.MESSAGE_SEPERATOR}`
  }

  return `${topic + SEP}E${SEP}${type}${SEP}${message}${C.MESSAGE_SEPERATOR}`
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param {String} msg generic error message
*
* @public
* @returns {void}
*/
SocketWrapper.prototype.sendError = function (topic, type, msg) {
 if (this.isClosed === false) {
   this.send(messageBuilder.<span class="apidocCodeKeywordSpan">getErrorMsg</span>(topic, type, msg))
 }
}

/**
* Sends a message based on the provided action and topic
*
* @param {String} topic one of C.TOPIC
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.message_builder.getMsg" id="apidoc.element.deepstream.io.message_builder.getMsg">
        function <span class="apidocSignatureSpan">deepstream.io.message_builder.</span>getMsg
        <span class="apidocSignatureSpan">(topic, action, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getMsg = function (topic, action, data) {
  const sendData = [topic, action]

  if (data) {
    for (let i = 0; i &lt; data.length; i++) {
      if (typeof data[i] === 'object') {
        sendData.push(JSON.stringify(data[i]))
      } else {
        sendData.push(data[i])
      }
    }
  }

  return sendData.join(SEP) + C.MESSAGE_SEPERATOR
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if (socket !== C.SOURCE_MESSAGE_CONNECTOR) {
  this._message.publish(C.TOPIC.EVENT, message)
}

this._subscriptionRegistry.sendToSubscribers(
  message.data[0],
  messageBuilder.<span class="apidocCodeKeywordSpan">getMsg</span>(C.TOPIC.EVENT, C.ACTIONS.EVENT, message.data),
  false,
  socket
)
}

EventHandler.prototype._sendError = function (socket, event, message) {
if (socket &amp;&amp; socket.sendError) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.message_builder.typed" id="apidoc.element.deepstream.io.message_builder.typed">
        function <span class="apidocSignatureSpan">deepstream.io.message_builder.</span>typed
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">typed = function (value) {
  const type = typeof value

  if (type === 'string') {
    return C.TYPES.STRING + value
  }

  if (value === null) {
    return C.TYPES.NULL
  }

  if (type === 'object') {
    return C.TYPES.OBJECT + JSON.stringify(value)
  }

  if (type === 'number') {
    return C.TYPES.NUMBER + value.toString()
  }

  if (value === true) {
    return C.TYPES.TRUE
  }

  if (value === false) {
    return C.TYPES.FALSE
  }

  if (value === undefined) {
    return C.TYPES.UNDEFINED
  }

  throw new Error(`Can't serialize type ${value}`)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this._appendDataToSocketWrapper(socketWrapper, userData)
if (typeof userData.clientData === 'undefined') {
  socketWrapper.sendMessage(C.TOPIC.AUTH, C.ACTIONS.ACK)
} else {
  socketWrapper.sendMessage(
    C.TOPIC.AUTH,
    C.ACTIONS.ACK,
    [messageBuilder.<span class="apidocCodeKeywordSpan">typed</span>(userData.clientData)]
  )
}

if (socketWrapper.user !== OPEN) {
  this.emit('client-connected', socketWrapper)
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.noop_message_connector" id="apidoc.module.deepstream.io.noop_message_connector">module deepstream.io.noop_message_connector</a></h1>




    <h2>
        <a href="#apidoc.element.deepstream.io.noop_message_connector.publish" id="apidoc.element.deepstream.io.noop_message_connector.publish">
        function <span class="apidocSignatureSpan">deepstream.io.noop_message_connector.</span>publish
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">publish = function () {}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   * @returns {[type]}
   */
  leaveCluster () {
if (this._inCluster === false) {
  return
}
this._options.logger.log(C.LOG_LEVEL.INFO, C.EVENT.CLUSTER_LEAVE, this._options.serverName)
this._options.messageConnector.<span class="apidocCodeKeywordSpan">publish</span>(C.TOPIC.CLUSTER, {
  topic: C.TOPIC.CLUSTER,
  action: C.ACTIONS.REMOVE,
  data: [this._options.serverName]
})

// TODO: If a message connector doesn't close this is required to avoid an error
// being thrown during shutdown
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.noop_message_connector.subscribe" id="apidoc.element.deepstream.io.noop_message_connector.subscribe">
        function <span class="apidocSignatureSpan">deepstream.io.noop_message_connector.</span>subscribe
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">subscribe = function () {}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this._nodes = {}

this._leaderScore = Math.random()
this.setMaxListeners(12)

this._onMessageFn = this._onMessage.bind(this)
this._leaveClusterFn = this.leaveCluster.bind(this)
this._options.messageConnector.<span class="apidocCodeKeywordSpan">subscribe</span>(C.TOPIC.CLUSTER, this._onMessageFn)
this._publishStatus()
this._publishInterval = setInterval(
  this._publishStatus.bind(this),
  this._options.clusterKeepAliveInterval
)
this._checkInterval = setInterval(
  this._checkNodes.bind(this),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.noop_message_connector.unsubscribe" id="apidoc.element.deepstream.io.noop_message_connector.unsubscribe">
        function <span class="apidocSignatureSpan">deepstream.io.noop_message_connector.</span>unsubscribe
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unsubscribe = function () {}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  topic: C.TOPIC.CLUSTER,
  action: C.ACTIONS.REMOVE,
  data: [this._options.serverName]
})

// TODO: If a message connector doesn't close this is required to avoid an error
// being thrown during shutdown
// this._options.messageConnector.<span class="apidocCodeKeywordSpan">unsubscribe</span>( C.TOPIC.CLUSTER, this._onMessageFn );

process.removeListener('beforeExit', this._leaveClusterFn)
process.removeListener('exit', this._leaveClusterFn)
clearInterval(this._publishInterval)
clearInterval(this._checkInterval)
this._nodes = {}
this._inCluster = false
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.noop_storage" id="apidoc.module.deepstream.io.noop_storage">module deepstream.io.noop_storage</a></h1>




    <h2>
        <a href="#apidoc.element.deepstream.io.noop_storage.delete" id="apidoc.element.deepstream.io.noop_storage.delete">
        function <span class="apidocSignatureSpan">deepstream.io.noop_storage.</span>delete
        <span class="apidocSignatureSpan">(key, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delete = function (key, callback) { callback(null) }</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
    if (p.test(subscriptionName)) {
      servers = servers.concat(providerRegistry.getAllServers(pattern))
    }
  }

  const set = new Set(servers)
  set.<span class="apidocCodeKeywordSpan">delete</span>(this._options.serverName)

  if (!this._options.shuffleListenProviders) {
    return Array.from(set)
  }
  return utils.shuffleArray(Array.from(set))
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.noop_storage.get" id="apidoc.element.deepstream.io.noop_storage.get">
        function <span class="apidocSignatureSpan">deepstream.io.noop_storage.</span>get
        <span class="apidocSignatureSpan">(key, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (key, callback) {
  callback(null, null)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 *
 * @param  {String}   urlPath URL where to download the archive
 * @param  {Stream}   writeable output stream to save the archive
 * @param  {Function} callback Callback (err)
 * @return {void}
 */
const downloadArchive = function (urlPath, outStream, callback) {
needle.<span class="apidocCodeKeywordSpan">get</span>(`https://github.com${urlPath}`, {
  follow_max: 5,
  headers: { 'User-Agent': 'nodejs-client' }
}, (error, response) =&gt; {
  if (error) {
    return callback(error)
  }
  outStream.write(response.body)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.noop_storage.set" id="apidoc.element.deepstream.io.noop_storage.set">
        function <span class="apidocSignatureSpan">deepstream.io.noop_storage.</span>set
        <span class="apidocSignatureSpan">(key, value, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">set = function (key, value, callback) { callback(null) }</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
ConfigPermissionHandler.prototype.setRecordHandler = function (recordHandler) {
this._recordHandler = recordHandler
}

/**
 * Will be called by the dependency initialiser once server.start() is called.
 * This gives users a chance to change the path using server.<span class="apidocCodeKeywordSpan">set</span>()
 * first
 *
 * @public
 * @returns {void}
 */
ConfigPermissionHandler.prototype.init = function () {
if (this._config === null &amp;&amp; this._optionsValid) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.path_parser" id="apidoc.module.deepstream.io.path_parser">module deepstream.io.path_parser</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.path_parser.parse" id="apidoc.element.deepstream.io.path_parser.parse">
        function <span class="apidocSignatureSpan">deepstream.io.path_parser.</span>parse
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parse = function (path) {
  const variables = []
  let regExp = path.replace(WILDCARD_REGEXP, WILDCARD_STRING)

  regExp = regExp.replace(VARIABLE_REGEXP, (variableName) =&gt; {
    variables.push(variableName)
    return VARIABLE_STRING
  })

  return {
    variables,
    path,
    regexp: new RegExp(`^${regExp}$`)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

function fetchLibs(libDir, meta) {
  const directory = libDir || 'lib'
  const files = glob.sync(path.join(directory, '*', 'package.json'))
  meta.libs = files.map((filePath) =&gt; {
    const pkg = fs.readFileSync(filePath, 'utf8')
    const object = JSON.<span class="apidocCodeKeywordSpan">parse</span>(pkg)
    return `${object.name}:${object.version}`
  })
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.path_parser.validate" id="apidoc.element.deepstream.io.path_parser.validate">
        function <span class="apidocSignatureSpan">deepstream.io.path_parser.</span>validate
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validate = function (path) {
  if (typeof path !== 'string') {
    return 'path must be a string'
  }

  if (path.length === 0) {
    return 'path can\'t be empty'
  }

  if (path[0] === '/') {
    return 'path can\'t start with /'
  }

  const invalidVariableNames = path.match(INVALID_VARIABLE_REGEXP)

  if (invalidVariableNames !== null) {
    return `invalid variable name ${invalidVariableNames[0]}`
  }

  return true
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 *
 * @param   {Object} config deepstream permissionConfig
 *
 * @public
 * @returns {void}
 */
ConfigPermissionHandler.prototype.useConfig = function (config) {
const validationResult = configValidator.<span class="apidocCodeKeywordSpan">validate</span>(config)

if (validationResult !== true) {
  this.emit('error', `invalid permission config - ${validationResult}`)
  return
}

this._config = configCompiler.compile(config)
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.pid_helper" id="apidoc.module.deepstream.io.pid_helper">module deepstream.io.pid_helper</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.pid_helper.ensureNotRunning" id="apidoc.element.deepstream.io.pid_helper.ensureNotRunning">
        function <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>ensureNotRunning
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ensureNotRunning = function (callback) {
  read((err, data) =&gt; {
    if (err) {
      if (err.code === 'ENOENT') {
        return callback()
      }
      return callback(err)
    }
    try {
      const pid = data.pid
      if (isRunning(pid)) {
        throw new Error(`A deepstream server is already running with PID ${pid}, see ${PID_FILE}`)
      } else {
				// pid file is there but process is not running anymore
        return callback()
      }
    } catch (err) {
      return callback(err)
    }
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  args.push('--lib-dir')
  args.push(this.libDir)
}
		// TODO: need to pass other options as well, which are accessable directly as properties of this
		//       but need to transform camelCase back to kebabCase, like disableAuth

		// ensure there is no pid file with a running process
pidHelper.<span class="apidocCodeKeywordSpan">ensureNotRunning</span>((err) =&gt; {
  if (err) {
    return pidHelper.exit(err)
  }
  const child = child_process.spawn(path.join(__dirname, 'deepstream'), ['start'].concat(args), {
    detached: true,
    stdio: ['ignore']
  })
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.pid_helper.exit" id="apidoc.element.deepstream.io.pid_helper.exit">
        function <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>exit
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">exit = function (err) {
  if (err instanceof Error) {
    console.error(colors.red(err.toString()))
    console.error(err)
    process.exit(1)
  } else {
    remove(() =&gt; {
      process.exit(0)
    })
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function hash(password) {
global.deepstreamCLI = this
const config = jsYamlLoader.loadConfigWithoutInitialisation().config

if (config.auth.type !== 'file') {
  console.error('Error: Can only use hash with file authentication as auth type')
  process.<span class="apidocCodeKeywordSpan">exit</span>(1)
}

if (!config.auth.options.hash) {
  console.error('Error: Can only use hash with file authentication')
  process.exit(1)
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.pid_helper.isRunning" id="apidoc.element.deepstream.io.pid_helper.isRunning">
        function <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>isRunning
        <span class="apidocSignatureSpan">(pid)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isRunning = function (pid) {
  try {
    return process.kill(pid, 0)
  } catch (e) {
    return e.code === 'EPERM'
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
const pidHelper = require('./pid-helper')

function statusCheck(cmd, program) {
  pidHelper.read((err, data) =&gt; {
    if (err) {
      return console.log('not running (no pid file)')
    }
    if (pidHelper.<span class="apidocCodeKeywordSpan">isRunning</span>(data.pid)) {
      const seconds = (new Date().getTime() - data.timestamp) / 1000
      console.log(`Process running with PID ${data.pid} since ${seconds} seconds`)
    } else {
      console.log(`Not running (no process for PID ${data.pid})`)
    }
  })
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.pid_helper.read" id="apidoc.element.deepstream.io.pid_helper.read">
        function <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>read
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function (callback) {
  fs.readFile(PID_FILE, 'utf8', (err, content) =&gt; {
    if (err) {
      return callback(err)
    }
    try {
      return callback(null, JSON.parse(content))
    } catch (err) {
      return callback(err)
    }
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


'use strict'

const pidHelper = require('./pid-helper')

function statusCheck(cmd, program) {
pidHelper.<span class="apidocCodeKeywordSpan">read</span>((err, data) =&gt; {
  if (err) {
    return console.log('not running (no pid file)')
  }
  if (pidHelper.isRunning(data.pid)) {
    const seconds = (new Date().getTime() - data.timestamp) / 1000
    console.log(`Process running with PID ${data.pid} since ${seconds} seconds`)
  } else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.pid_helper.save" id="apidoc.element.deepstream.io.pid_helper.save">
        function <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>save
        <span class="apidocSignatureSpan">(pid, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">save = function (pid, callback) {
  if (callback == null) {
    callback = function () {}
  }
  if (pid == null) {
    return callback(new Error('pid is null'))
  }
  const now = new Date()
  const data = {
    pid,
    timestamp: now.getTime(),
    time: now.toString()
  }
  fs.writeFile(PID_FILE, JSON.stringify(data), (err) =&gt; {
    callback(err)
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  } else {
		// non-detach case
const Deepstream = require('../src/deepstream.io.js')
try {
  process.on('uncaughtException', pidHelper.exit)
  const ds = new Deepstream(null)
  ds.on('started', () =&gt; {
    pidHelper.<span class="apidocCodeKeywordSpan">save</span>(process.pid)
  })
  ds.start()
} catch (err) {
  console.error(err.toString())
  console.trace()
  process.exit(1)
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.pid_helper.stop" id="apidoc.element.deepstream.io.pid_helper.stop">
        function <span class="apidocSignatureSpan">deepstream.io.pid_helper.</span>stop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">stop = function () {
  read((err, data) =&gt; {
    if (err) {
      return console.log('no pid file')
    } else {
      try {
        process.kill(data.pid)
      } catch (err) {
        return console.log(`No process found for PID ${data.pid}`)
      }
      const uptime = new Date().getTime() - data.timestamp
      console.log(`Deepstream was running for ${uptime / 1000} seconds`)
    }
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.record_deletion" id="apidoc.module.deepstream.io.record_deletion">module deepstream.io.record_deletion</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.record_deletion.record_deletion" id="apidoc.element.deepstream.io.record_deletion.record_deletion">
        function <span class="apidocSignatureSpan">deepstream.io.</span>record_deletion
        <span class="apidocSignatureSpan">(options, socketWrapper, message, successCallback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">record_deletion = function (options, socketWrapper, message, successCallback) {
  this._options = options
  this._socketWrapper = socketWrapper
  this._message = message
  this._successCallback = successCallback
  this._recordName = message.data[0]
  this._completed = 0
  this._isDestroyed = false

  this._cacheTimeout = setTimeout(
    this._handleError.bind(this, 'cache timeout'),
    this._options.cacheRetrievalTimeout
  )
  this._options.cache.delete(
    this._recordName,
    this._checkIfDone.bind(this, this._cacheTimeout)
  )

  if (!this._options.storageExclusion || !this._options.storageExclusion.test(this._recordName)) {
    this._storageTimeout = setTimeout(
      this._handleError.bind(this, 'storage timeout'),
      this._options.storageRetrievalTimeout
    )
    this._options.storage.delete(
      this._recordName,
      this._checkIfDone.bind(this, this._storageTimeout)
    )
  } else {
    this._checkIfDone(null)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.record_deletion.prototype" id="apidoc.module.deepstream.io.record_deletion.prototype">module deepstream.io.record_deletion.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.record_deletion.prototype._checkIfDone" id="apidoc.element.deepstream.io.record_deletion.prototype._checkIfDone">
        function <span class="apidocSignatureSpan">deepstream.io.record_deletion.prototype.</span>_checkIfDone
        <span class="apidocSignatureSpan">(timeoutId, error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_checkIfDone = function (timeoutId, error) {
  clearTimeout(timeoutId)
  this._completed++

  if (this._isDestroyed) {
    return
  }

  if (error) {
    this._handleError(error.toString())
    return
  }

  if (this._completed === 2) {
    this._done()
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
     this._options.storageRetrievalTimeout
   )
   this._options.storage.delete(
     this._recordName,
     this._checkIfDone.bind(this, this._storageTimeout)
   )
 } else {
   this.<span class="apidocCodeKeywordSpan">_checkIfDone</span>(null)
 }
}

/**
* Callback for completed cache and storage interactions. Will invoke
* _done() once both are completed
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_deletion.prototype._destroy" id="apidoc.element.deepstream.io.record_deletion.prototype._destroy">
        function <span class="apidocSignatureSpan">deepstream.io.record_deletion.prototype.</span>_destroy
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_destroy = function () {
  clearTimeout(this._cacheTimeout)
  clearTimeout(this._storageTimeout)
  this._options = null
  this._socketWrapper = null
  this._message = null
  this._isDestroyed = true
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   * @private
   * @returns {void}
   */
  _onComplete (error, response) {
if (error) {
  this._logger.log(C.LOG_LEVEL.WARN, C.EVENT.AUTH_ERROR, `http auth error: ${error}`)
  this._callback(false, null)
  this.<span class="apidocCodeKeywordSpan">_destroy</span>()
  return
}

if (response.statusCode &gt;= 500 &amp;&amp; response.statusCode &lt; 600) {
  this._logger.log(C.LOG_LEVEL.WARN, C.EVENT.AUTH_ERROR, `http auth server error: ${response.body}`)
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_deletion.prototype._done" id="apidoc.element.deepstream.io.record_deletion.prototype._done">
        function <span class="apidocSignatureSpan">deepstream.io.record_deletion.prototype.</span>_done
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_done = function () {
  this._options.logger.log(C.LOG_LEVEL.INFO, C.EVENT.RECORD_DELETION, this._recordName)

  const ackMessage = {
    topic: C.TOPIC.RECORD,
    action: C.ACTIONS.ACK,
    data: [C.ACTIONS.DELETE, this._recordName],
    raw: messageBuilder.getMsg(C.TOPIC.RECORD, C.ACTIONS.ACK, [C.ACTIONS.DELETE, this._recordName])
  }

  this._socketWrapper.send(ackMessage.raw)
  this._successCallback(this._recordName, ackMessage, this._socketWrapper)
  this._destroy()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

 if (error) {
   this._handleError(error.toString())
   return
 }

 if (this._completed === 2) {
   this.<span class="apidocCodeKeywordSpan">_done</span>()
 }
}

/**
* Callback for successful deletions. Notifies the original sender and calls
* the callback to allow the recordHandler to broadcast the deletion
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_deletion.prototype._handleError" id="apidoc.element.deepstream.io.record_deletion.prototype._handleError">
        function <span class="apidocSignatureSpan">deepstream.io.record_deletion.prototype.</span>_handleError
        <span class="apidocSignatureSpan">(errorMsg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_handleError = function (errorMsg) {
  this._socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.RECORD_DELETE_ERROR, errorMsg)
  this._options.logger.log(C.LOG_LEVEL.ERROR, C.EVENT.RECORD_DELETE_ERROR, errorMsg)
  this._destroy()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this._completed++

  if (this._isDestroyed) {
    return
  }

  if (error) {
    this.<span class="apidocCodeKeywordSpan">_handleError</span>(error.toString())
    return
  }

  if (this._completed === 2) {
    this._done()
  }
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.record_handler" id="apidoc.module.deepstream.io.record_handler">module deepstream.io.record_handler</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.record_handler" id="apidoc.element.deepstream.io.record_handler.record_handler">
        function <span class="apidocSignatureSpan">deepstream.io.</span>record_handler
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">record_handler = function (options) {
  this._options = options
  this._subscriptionRegistry = new SubscriptionRegistry(options, C.TOPIC.RECORD)
  this._listenerRegistry = new ListenerRegistry(C.TOPIC.RECORD, options, this._subscriptionRegistry)
  this._subscriptionRegistry.setSubscriptionListener(this._listenerRegistry)
  this._transitions = {}
  this._recordRequestsInProgress = {}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.record_handler.prototype" id="apidoc.module.deepstream.io.record_handler.prototype">module deepstream.io.record_handler.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype._create" id="apidoc.element.deepstream.io.record_handler.prototype._create">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_create
        <span class="apidocSignatureSpan">(recordName, socketWrapper)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_create = function (recordName, socketWrapper) {
  const record = {
    _v: 0,
    _d: {}
  }

  // store the records data in the cache and wait for the result
  this._options.cache.set(recordName, record, (error) =&gt; {
    if (error) {
      this._options.logger.log(C.LOG_LEVEL.ERROR, C.EVENT.RECORD_CREATE_ERROR, recordName)
      socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.RECORD_CREATE_ERROR, recordName)
    } else {
      this._read(recordName, record, socketWrapper)
    }
  })

  if (!this._options.storageExclusion || !this._options.storageExclusion.test(recordName)) {
    // store the record data in the persistant storage independently and don't wait for the result
    this._options.storage.set(recordName, record, (error) =&gt; {
      if (error) {
        this._options.logger.log(C.LOG_LEVEL.ERROR, C.EVENT.RECORD_CREATE_ERROR, `storage:${error}`)
      }
    })
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype._createOrRead" id="apidoc.element.deepstream.io.record_handler.prototype._createOrRead">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_createOrRead
        <span class="apidocSignatureSpan">(socketWrapper, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_createOrRead = function (socketWrapper, message) {
  const recordName = message.data[0]

  const onComplete = function (record) {
    if (record) {
      this._read(recordName, record, socketWrapper)
    } else {
      this._permissionAction(
        C.ACTIONS.CREATE,
        recordName,
        socketWrapper,
        this._create.bind(this, recordName, socketWrapper)
      )
    }
  }

  // eslint-disable-next-line
  new RecordRequest(
    recordName,
    this._options,
    socketWrapper,
    onComplete.bind(this)
  )
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

if (message.action === C.ACTIONS.CREATEORREAD) {
  /*
   * Return the record's contents and subscribes for future updates.
   * Creates the record if it doesn't exist
   */
  this.<span class="apidocCodeKeywordSpan">_createOrRead</span>(socketWrapper, message)
} else if (message.action === C.ACTIONS.SNAPSHOT) {
  /*
   * Return the current state of the record in cache or db
   */
  this._snapshot(socketWrapper, message)
} else if (message.action === C.ACTIONS.HEAD) {
  /*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype._delete" id="apidoc.element.deepstream.io.record_handler.prototype._delete">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_delete
        <span class="apidocSignatureSpan">(socketWrapper, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_delete = function (socketWrapper, message) {
  const recordName = message.data[0]

  if (this._transitions[recordName]) {
    this._transitions[recordName].destroy()
    delete this._transitions[recordName]
  }

  if (socketWrapper === C.SOURCE_MESSAGE_CONNECTOR) {
    this._onDeleted(recordName, message, socketWrapper)
  } else {
    // eslint-disable-next-line
    new RecordDeletion(this._options, socketWrapper, message, this._onDeleted.bind(this))
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   * Handle complete (UPDATE) or partial (PATCH) updates
   */
  this._update(socketWrapper, message)
} else if (message.action === C.ACTIONS.DELETE) {
  /*
   * Deletes the record
   */
  this.<span class="apidocCodeKeywordSpan">_delete</span>(socketWrapper, message)
} else if (message.action === C.ACTIONS.UNSUBSCRIBE) {
/*
 * Unsubscribes (discards) a record that was previously subscribed to
 * using read()
 */
  this._subscriptionRegistry.unsubscribe(message.data[0], socketWrapper)
} else if (message.action === C.ACTIONS.LISTEN ||
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype._hasRecord" id="apidoc.element.deepstream.io.record_handler.prototype._hasRecord">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_hasRecord
        <span class="apidocSignatureSpan">(socketWrapper, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_hasRecord = function (socketWrapper, message) {
  const recordName = message.data[0]

  const onComplete = function (record) {
    const hasRecord = record ? C.TYPES.TRUE : C.TYPES.FALSE
    socketWrapper.sendMessage(C.TOPIC.RECORD, C.ACTIONS.HAS, [recordName, hasRecord])
  }
  const onError = function (error) {
    socketWrapper.sendError(C.TOPIC.RECORD, C.ACTIONS.HAS, [recordName, error])
  }

  // eslint-disable-next-line
  new RecordRequest(recordName,
    this._options,
    socketWrapper,
    onComplete.bind(this),
    onError.bind(this)
  )
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   * Return the current state of the record in cache or db
   */
  this._head(socketWrapper, message)
} else if (message.action === C.ACTIONS.HAS) {
  /*
   * Return a Boolean to indicate if record exists in cache or database
   */
  this.<span class="apidocCodeKeywordSpan">_hasRecord</span>(socketWrapper, message)
} else if (message.action === C.ACTIONS.UPDATE || message.action === C.ACTIONS.PATCH) {
  /*
   * Handle complete (UPDATE) or partial (PATCH) updates
   */
  this._update(socketWrapper, message)
} else if (message.action === C.ACTIONS.DELETE) {
  /*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype._head" id="apidoc.element.deepstream.io.record_handler.prototype._head">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_head
        <span class="apidocSignatureSpan">(socketWrapper, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_head = function (socketWrapper, message) {
  const recordName = message.data[0]

  const onComplete = function (record) {
    if (record) {
      socketWrapper.sendMessage(C.TOPIC.RECORD, C.ACTIONS.HEAD, [recordName, record._v])
    } else {
      socketWrapper.sendError(
        C.TOPIC.RECORD,
        C.ACTIONS.HEAD,
        [recordName, C.EVENT.RECORD_NOT_FOUND]
      )
    }
  }
  const onError = function (error) {
    socketWrapper.sendError(C.TOPIC.RECORD, C.ACTIONS.HEAD, [recordName, error])
  }

  // eslint-disable-next-line
  new RecordRequest(
    recordName,
    this._options,
    socketWrapper,
    onComplete.bind(this),
    onError.bind(this)
  )
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   * Return the current state of the record in cache or db
   */
  this._snapshot(socketWrapper, message)
} else if (message.action === C.ACTIONS.HEAD) {
  /*
   * Return the current state of the record in cache or db
   */
  this.<span class="apidocCodeKeywordSpan">_head</span>(socketWrapper, message)
} else if (message.action === C.ACTIONS.HAS) {
  /*
   * Return a Boolean to indicate if record exists in cache or database
   */
  this._hasRecord(socketWrapper, message)
} else if (message.action === C.ACTIONS.UPDATE || message.action === C.ACTIONS.PATCH) {
  /*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype._onDeleted" id="apidoc.element.deepstream.io.record_handler.prototype._onDeleted">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_onDeleted
        <span class="apidocSignatureSpan">(name, message, originalSender)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onDeleted = function (name, message, originalSender) {
  this._$broadcastUpdate(name, message, true, originalSender)

  for (const subscriber of this._subscriptionRegistry.getLocalSubscribers(name)) {
    this._subscriptionRegistry.unsubscribe(name, subscriber, true)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  if (this._transitions[recordName]) {
    this._transitions[recordName].destroy()
    delete this._transitions[recordName]
  }

  if (socketWrapper === C.SOURCE_MESSAGE_CONNECTOR) {
    this.<span class="apidocCodeKeywordSpan">_onDeleted</span>(recordName, message, socketWrapper)
  } else {
    // eslint-disable-next-line
    new RecordDeletion(this._options, socketWrapper, message, this._onDeleted.bind(this))
  }
}

/*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype._permissionAction" id="apidoc.element.deepstream.io.record_handler.prototype._permissionAction">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_permissionAction
        <span class="apidocSignatureSpan">( action, recordName, socketWrapper, successCallback )</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_permissionAction = function ( action, recordName, socketWrapper, successCallback ) {
  const message = {
    topic: C.TOPIC.RECORD,
    action,
    data: [recordName]
  }

  const onResult = function (error, canPerformAction) {
    if (error !== null) {
      socketWrapper.sendError(message.topic, C.EVENT.MESSAGE_PERMISSION_ERROR, error.toString())
    } else if (canPerformAction !== true) {
      socketWrapper.sendError(message.topic, C.EVENT.MESSAGE_DENIED, [recordName, action])
    } else {
      successCallback()
    }
  }

  this._options.permissionHandler.canPerformAction(
    socketWrapper.user,
    message,
    onResult,
    socketWrapper.authData
  )
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
RecordHandler.prototype._createOrRead = function (socketWrapper, message) {
const recordName = message.data[0]

const onComplete = function (record) {
  if (record) {
    this._read(recordName, record, socketWrapper)
  } else {
    this.<span class="apidocCodeKeywordSpan">_permissionAction</span>(
      C.ACTIONS.CREATE,
      recordName,
      socketWrapper,
      this._create.bind(this, recordName, socketWrapper)
    )
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype._read" id="apidoc.element.deepstream.io.record_handler.prototype._read">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_read
        <span class="apidocSignatureSpan">(recordName, record, socketWrapper)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_read = function (recordName, record, socketWrapper) {
  this._permissionAction(C.ACTIONS.READ, recordName, socketWrapper, () =&gt; {
    this._subscriptionRegistry.subscribe(recordName, socketWrapper)
    this._sendRecord(recordName, record, socketWrapper)
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @returns {void}
 */
RecordHandler.prototype._createOrRead = function (socketWrapper, message) {
const recordName = message.data[0]

const onComplete = function (record) {
  if (record) {
    this.<span class="apidocCodeKeywordSpan">_read</span>(recordName, record, socketWrapper)
  } else {
    this._permissionAction(
      C.ACTIONS.CREATE,
      recordName,
      socketWrapper,
      this._create.bind(this, recordName, socketWrapper)
    )
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype._sendRecord" id="apidoc.element.deepstream.io.record_handler.prototype._sendRecord">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_sendRecord
        <span class="apidocSignatureSpan">(recordName, record, socketWrapper)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_sendRecord = function (recordName, record, socketWrapper) {
  socketWrapper.sendMessage(C.TOPIC.RECORD, C.ACTIONS.READ, [recordName, record._v, record._d])
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @returns {void}
 */
RecordHandler.prototype._snapshot = function (socketWrapper, message) {
const recordName = message.data[0]

const onComplete = function (record) {
  if (record) {
    this.<span class="apidocCodeKeywordSpan">_sendRecord</span>(recordName, record, socketWrapper)
  } else {
    socketWrapper.sendError(
      C.TOPIC.RECORD,
      C.ACTIONS.SNAPSHOT,
      [recordName, C.EVENT.RECORD_NOT_FOUND]
    )
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype._snapshot" id="apidoc.element.deepstream.io.record_handler.prototype._snapshot">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_snapshot
        <span class="apidocSignatureSpan">(socketWrapper, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_snapshot = function (socketWrapper, message) {
  const recordName = message.data[0]

  const onComplete = function (record) {
    if (record) {
      this._sendRecord(recordName, record, socketWrapper)
    } else {
      socketWrapper.sendError(
        C.TOPIC.RECORD,
        C.ACTIONS.SNAPSHOT,
        [recordName, C.EVENT.RECORD_NOT_FOUND]
      )
    }
  }
  const onError = function (error) {
    socketWrapper.sendError(C.TOPIC.RECORD, C.ACTIONS.SNAPSHOT, [recordName, error])
  }

  // eslint-disable-next-line
  new RecordRequest(
    recordName,
    this._options,
    socketWrapper,
    onComplete.bind(this),
    onError.bind(this)
  )
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   * Creates the record if it doesn't exist
   */
  this._createOrRead(socketWrapper, message)
} else if (message.action === C.ACTIONS.SNAPSHOT) {
  /*
   * Return the current state of the record in cache or db
   */
  this.<span class="apidocCodeKeywordSpan">_snapshot</span>(socketWrapper, message)
} else if (message.action === C.ACTIONS.HEAD) {
  /*
   * Return the current state of the record in cache or db
   */
  this._head(socketWrapper, message)
} else if (message.action === C.ACTIONS.HAS) {
  /*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype._update" id="apidoc.element.deepstream.io.record_handler.prototype._update">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>_update
        <span class="apidocSignatureSpan">(socketWrapper, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_update = function (socketWrapper, message) {
  if (message.data.length &lt; 3) {
    socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.INVALID_MESSAGE_DATA, message.data[0])
    return
  }

  const recordName = message.data[0]
  const version = parseInt(message.data[1], 10)

<span class="apidocCodeCommentSpan">  /*
   * If the update message is received from the message bus, rather than from a client,
   * assume that the original deepstream node has already updated the record in cache and
   * storage and only broadcast the message to subscribers
   */
</span>  if (socketWrapper === C.SOURCE_MESSAGE_CONNECTOR) {
    this._$broadcastUpdate(recordName, message, false, socketWrapper)
    return
  }

  if (isNaN(version)) {
    socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.INVALID_VERSION, [recordName, version])
    return
  }

  if (this._transitions[recordName] &amp;&amp; this._transitions[recordName].hasVersion(version)) {
    this._transitions[recordName].sendVersionExists({ message, version, sender: socketWrapper })
    return
  }

  if (!this._transitions[recordName]) {
    this._transitions[recordName] = new RecordTransition(recordName, this._options, this)
  }

  this._transitions[recordName].add(socketWrapper, version, message)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   * Return a Boolean to indicate if record exists in cache or database
   */
  this._hasRecord(socketWrapper, message)
} else if (message.action === C.ACTIONS.UPDATE || message.action === C.ACTIONS.PATCH) {
  /*
   * Handle complete (UPDATE) or partial (PATCH) updates
   */
  this.<span class="apidocCodeKeywordSpan">_update</span>(socketWrapper, message)
} else if (message.action === C.ACTIONS.DELETE) {
  /*
   * Deletes the record
   */
  this._delete(socketWrapper, message)
} else if (message.action === C.ACTIONS.UNSUBSCRIBE) {
/*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype.handle" id="apidoc.element.deepstream.io.record_handler.prototype.handle">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>handle
        <span class="apidocSignatureSpan">(socketWrapper, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handle = function (socketWrapper, message) {
<span class="apidocCodeCommentSpan">  /*
   * All messages have to provide at least the name of the record they relate to
   * or a pattern in case of listen
   */
</span>  if (!message.data || message.data.length &lt; 1) {
    socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.INVALID_MESSAGE_DATA, message.raw)
    return
  }

  if (message.action === C.ACTIONS.CREATEORREAD) {
    /*
     * Return the record's contents and subscribes for future updates.
     * Creates the record if it doesn't exist
     */
    this._createOrRead(socketWrapper, message)
  } else if (message.action === C.ACTIONS.SNAPSHOT) {
    /*
     * Return the current state of the record in cache or db
     */
    this._snapshot(socketWrapper, message)
  } else if (message.action === C.ACTIONS.HEAD) {
    /*
     * Return the current state of the record in cache or db
     */
    this._head(socketWrapper, message)
  } else if (message.action === C.ACTIONS.HAS) {
    /*
     * Return a Boolean to indicate if record exists in cache or database
     */
    this._hasRecord(socketWrapper, message)
  } else if (message.action === C.ACTIONS.UPDATE || message.action === C.ACTIONS.PATCH) {
    /*
     * Handle complete (UPDATE) or partial (PATCH) updates
     */
    this._update(socketWrapper, message)
  } else if (message.action === C.ACTIONS.DELETE) {
    /*
     * Deletes the record
     */
    this._delete(socketWrapper, message)
  } else if (message.action === C.ACTIONS.UNSUBSCRIBE) {
  /*
   * Unsubscribes (discards) a record that was previously subscribed to
   * using read()
   */
    this._subscriptionRegistry.unsubscribe(message.data[0], socketWrapper)
  } else if (message.action === C.ACTIONS.LISTEN ||
  /*
   * Listen to requests for a particular record or records
   * whose names match a pattern
   */
    message.action === C.ACTIONS.UNLISTEN ||
    message.action === C.ACTIONS.LISTEN_ACCEPT ||
    message.action === C.ACTIONS.LISTEN_REJECT ||
    message.action === C.ACTIONS.LISTEN_SNAPSHOT) {
    this._listenerRegistry.handle(socketWrapper, message)
  } else {
  /*
   * Default for invalid messages
   */
    this._options.logger.log(C.LOG_LEVEL.WARN, C.EVENT.UNKNOWN_ACTION, message.action)

    if (socketWrapper !== C.SOURCE_MESSAGE_CONNECTOR) {
      socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.UNKNOWN_ACTION, `unknown action ${message.action}`)
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   this._removeSubscriber(socket, message)
 } else if (message.action === C.ACTIONS.EVENT) {
   this._triggerEvent(socket, message)
 } else if (message.action === C.ACTIONS.LISTEN ||
   message.action === C.ACTIONS.UNLISTEN ||
   message.action === C.ACTIONS.LISTEN_ACCEPT ||
   message.action === C.ACTIONS.LISTEN_REJECT) {
   this._listenerRegistry.<span class="apidocCodeKeywordSpan">handle</span>(socket, message)
 } else {
   this._sendError(socket, C.EVENT.UNKNOWN_ACTION, `unknown action ${message.action}`)
 }
}

/**
* Handler for the SUBSCRIBE action. Adds the socket as
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype.removeRecordRequest" id="apidoc.element.deepstream.io.record_handler.prototype.removeRecordRequest">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>removeRecordRequest
        <span class="apidocSignatureSpan">(recordName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeRecordRequest = function (recordName) {
  if (!this._recordRequestsInProgress[recordName]) {
    return
  }

  if (this._recordRequestsInProgress[recordName].length === 0) {
    delete this._recordRequestsInProgress[recordName]
    return
  }

  const callback = this._recordRequestsInProgress[recordName].splice(0, 1)[0]
  callback(recordName)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Destroys this class and nulls down values to avoid
 * memory leaks
 *
 * @private
 * @returns {void}
 */
RuleApplication.prototype._destroy = function () {
this._params.recordHandler.<span class="apidocCodeKeywordSpan">removeRecordRequest</span>(this._params.name)
this._isDestroyed = true
this._runScheduled = false
this._params = null
this._crossReferenceFn = null
this._pathVars = null
this._user = null
this._recordData = null
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_handler.prototype.runWhenRecordStable" id="apidoc.element.deepstream.io.record_handler.prototype.runWhenRecordStable">
        function <span class="apidocSignatureSpan">deepstream.io.record_handler.prototype.</span>runWhenRecordStable
        <span class="apidocSignatureSpan">(recordName, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">runWhenRecordStable = function (recordName, callback) {
  if (
    !this._recordRequestsInProgress[recordName] ||
    this._recordRequestsInProgress[recordName].length === 0
  ) {
    this._recordRequestsInProgress[recordName] = []
    callback(recordName)
  } else {
    this._recordRequestsInProgress[recordName].push(callback)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 if (typeof this._recordData[recordName] !== UNDEFINED) {
   this._onLoadComplete(recordName, this._recordData[recordName])
   return
 }

 this._recordData[recordName] = LOADING

 this._params.recordHandler.<span class="apidocCodeKeywordSpan">runWhenRecordStable</span>(
   recordName,
   this._createNewRecordRequest.bind(this)
 )
}

/**
* Load the record data from the cache for permissioning. This method should be
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.record_request" id="apidoc.module.deepstream.io.record_request">module deepstream.io.record_request</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.record_request.record_request" id="apidoc.element.deepstream.io.record_request.record_request">
        function <span class="apidocSignatureSpan">deepstream.io.</span>record_request
        <span class="apidocSignatureSpan">(recordName, options, socketWrapper, onComplete, onError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">record_request = function (recordName, options, socketWrapper, onComplete, onError) {
  this._recordName = recordName
  this._options = options
  this._socketWrapper = socketWrapper
  this._storageRetrievalTimeout = null
  this._onComplete = onComplete
  this._onError = onError
  this._isDestroyed = false

  this._cacheRetrievalTimeout = setTimeout(
    this._sendError.bind(this, C.EVENT.CACHE_RETRIEVAL_TIMEOUT, this._recordName),
    this._options.cacheRetrievalTimeout
  )

  this._options.cache.get(this._recordName, this._onCacheResponse.bind(this))
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.record_request.prototype" id="apidoc.module.deepstream.io.record_request.prototype">module deepstream.io.record_request.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.record_request.prototype._destroy" id="apidoc.element.deepstream.io.record_request.prototype._destroy">
        function <span class="apidocSignatureSpan">deepstream.io.record_request.prototype.</span>_destroy
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_destroy = function () {
  clearTimeout(this._cacheRetrievalTimeout)
  clearTimeout(this._storageRetrievalTimeout)
  this._recordName = null
  this._options = null
  this._socketWrapper = null
  this._storageRetrievalTimeout = null
  this._onComplete = null
  this._onError = null
  this._isDestroyed = true
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   * @private
   * @returns {void}
   */
  _onComplete (error, response) {
if (error) {
  this._logger.log(C.LOG_LEVEL.WARN, C.EVENT.AUTH_ERROR, `http auth error: ${error}`)
  this._callback(false, null)
  this.<span class="apidocCodeKeywordSpan">_destroy</span>()
  return
}

if (response.statusCode &gt;= 500 &amp;&amp; response.statusCode &lt; 600) {
  this._logger.log(C.LOG_LEVEL.WARN, C.EVENT.AUTH_ERROR, `http auth server error: ${response.body}`)
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_request.prototype._onCacheResponse" id="apidoc.element.deepstream.io.record_request.prototype._onCacheResponse">
        function <span class="apidocSignatureSpan">deepstream.io.record_request.prototype.</span>_onCacheResponse
        <span class="apidocSignatureSpan">(error, record)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onCacheResponse = function (error, record) {
  clearTimeout(this._cacheRetrievalTimeout)

  if (this._isDestroyed === true) {
    return
  }

  if (error) {
    this._sendError(C.EVENT.RECORD_LOAD_ERROR, `error while loading ${this._recordName} from cache:${error.toString()}`)
  } else if (record) {
    this._onComplete(record)
  } else if (
      !this._options.storageExclusion ||
      !this._options.storageExclusion.test(this._recordName)
    ) {
    this._storageRetrievalTimeout = setTimeout(
      this._sendError.bind(this, C.EVENT.STORAGE_RETRIEVAL_TIMEOUT, this._recordName),
      this._options.storageRetrievalTimeout
    )
    this._options.storage.get(this._recordName, this._onStorageResponse.bind(this))
  } else {
    this._onComplete(null)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_request.prototype._onStorageResponse" id="apidoc.element.deepstream.io.record_request.prototype._onStorageResponse">
        function <span class="apidocSignatureSpan">deepstream.io.record_request.prototype.</span>_onStorageResponse
        <span class="apidocSignatureSpan">(error, record)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onStorageResponse = function (error, record) {
  clearTimeout(this._storageRetrievalTimeout)

  if (this._isDestroyed === true) {
    return
  }

  if (error) {
    this._sendError(
      C.EVENT.RECORD_LOAD_ERROR,
      `error while loading ${this._recordName} from storage:${error.toString()}`
    )
  } else {
    this._onComplete(record || null)

    if (record) {
<span class="apidocCodeCommentSpan">      /*
       * Load record from storage into cache
       */
</span>      this._options.cache.set(this._recordName, record, () =&gt; {})
    }

    this._destroy()
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_request.prototype._sendError" id="apidoc.element.deepstream.io.record_request.prototype._sendError">
        function <span class="apidocSignatureSpan">deepstream.io.record_request.prototype.</span>_sendError
        <span class="apidocSignatureSpan">(event, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_sendError = function (event, message) {
  this._options.logger.log(C.LOG_LEVEL.ERROR, event, message)
  if (this._socketWrapper) {
    this._socketWrapper.sendError(C.TOPIC.RECORD, event, message)
  }
  if (this._onError) {
    this._onError(event, message)
  }
  this._destroy()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   this._triggerEvent(socket, message)
 } else if (message.action === C.ACTIONS.LISTEN ||
   message.action === C.ACTIONS.UNLISTEN ||
   message.action === C.ACTIONS.LISTEN_ACCEPT ||
   message.action === C.ACTIONS.LISTEN_REJECT) {
   this._listenerRegistry.handle(socket, message)
 } else {
   this.<span class="apidocCodeKeywordSpan">_sendError</span>(socket, C.EVENT.UNKNOWN_ACTION, `unknown action ${message.action}`)
 }
}

/**
* Handler for the SUBSCRIBE action. Adds the socket as
* a subscriber to the specified event name
*
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.record_transition" id="apidoc.module.deepstream.io.record_transition">module deepstream.io.record_transition</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.record_transition" id="apidoc.element.deepstream.io.record_transition.record_transition">
        function <span class="apidocSignatureSpan">deepstream.io.</span>record_transition
        <span class="apidocSignatureSpan">(name, options, recordHandler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">record_transition = function (name, options, recordHandler) {
  this._name = name
  this._options = options
  this._recordHandler = recordHandler
  this._steps = []
  this._record = null
  this._currentStep = null
  this._recordRequest = null
  this._sendVersionExists = []
  this.isDestroyed = false
  this._pendingUpdates = {}
  this._ending = false
  this._storageResponses = 0
  this._cacheResponses = 0
  this._lastVersion = null
  this._lastError = null
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition._getRecordConfig" id="apidoc.element.deepstream.io.record_transition._getRecordConfig">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.</span>_getRecordConfig
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getRecordConfig = function (message) {
  let config
  if (message.action === C.ACTIONS.PATCH &amp;&amp; message.data.length === 5) {
    config = message.data[4]
  } else if (message.action === C.ACTIONS.UPDATE &amp;&amp; message.data.length === 4) {
    config = message.data[3]
  }

  if (!config) {
    return null
  }

  return JSON.parse(config)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  version,
  upsert: false,
  sender: socketWrapper
}
let data

try {
  const config = RecordTransition.<span class="apidocCodeKeywordSpan">_getRecordConfig</span>(message)
  this._applyConfig(config, update)
} catch (e) {
  update.sender.sendError(
    C.TOPIC.RECORD,
    C.EVENT.INVALID_CONFIG_DATA,
    message.data[4] || message.data[3]
  )
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.record_transition.prototype" id="apidoc.module.deepstream.io.record_transition.prototype">module deepstream.io.record_transition.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype._applyConfig" id="apidoc.element.deepstream.io.record_transition.prototype._applyConfig">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_applyConfig
        <span class="apidocSignatureSpan">(config, step)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_applyConfig = function (config, step) {
  if (!config) {
    return
  }

  if (config.writeSuccess) {
    if (this._pendingUpdates[step.sender.uuid] === undefined) {
      this._pendingUpdates[step.sender.uuid] = {
        socketWrapper: step.sender,
        versions: [step.version]
      }
    } else {
      const update = this._pendingUpdates[step.sender.uuid]
      update.versions.push(step.version)
    }
  }

  if (config.upsert) {
    step.upsert = true
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  upsert: false,
  sender: socketWrapper
}
let data

try {
  const config = RecordTransition._getRecordConfig(message)
  this.<span class="apidocCodeKeywordSpan">_applyConfig</span>(config, update)
} catch (e) {
  update.sender.sendError(
    C.TOPIC.RECORD,
    C.EVENT.INVALID_CONFIG_DATA,
    message.data[4] || message.data[3]
  )
  return
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype._flushVersionExists" id="apidoc.element.deepstream.io.record_transition.prototype._flushVersionExists">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_flushVersionExists
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_flushVersionExists = function () {
  for (let i = 0; i &lt; this._sendVersionExists.length; i++) {
    const conflict = this._sendVersionExists[i]
    this.sendVersionExists(conflict)
  }
  this._sendVersionExists = []
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param   {Object} record
*
* @private
* @returns {void}
*/
RecordTransition.prototype._processRecord = function (record) {
 this._record = record
 this.<span class="apidocCodeKeywordSpan">_flushVersionExists</span>()
 this._next()
}


/**
* Once the record is loaded this method is called recoursively
* for every step in the queue of pending updates.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype._next" id="apidoc.element.deepstream.io.record_transition.prototype._next">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_next
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_next = function () {
  if (this.isDestroyed === true) {
    return
  }

  if (this._steps.length === 0) {
    if (this._cacheResponses === 0 &amp;&amp; this._storageResponses === 0) {
      this.destroy()
    }
    return
  }

  this._currentStep = this._steps.shift()
  if (this._currentStep.version === -1) {
    const message = this._currentStep.message
    const version = this._record._v + 1
    this._currentStep.version = message.data[1] = version
    // Raw message is rebroadcast, needs to be rebuilt with new version number
    message.raw = messageBuilder.getMsg(message.topic, message.action, message.data)
  }

  if (this._record._v !== this._currentStep.version - 1) {
    this._cacheResponses--
    this.sendVersionExists(this._currentStep)
    this._next()
    return
  }

  this._record._v = this._currentStep.version

  if (this._currentStep.isPatch) {
    (new JsonPath(this._currentStep.path)).setValue(this._record._d, this._currentStep.data)
  } else {
    this._record._d = this._currentStep.data
  }

<span class="apidocCodeCommentSpan">  /*
   * Please note: saving to storage is called first to allow for synchronous cache
   * responses to destroy the transition, it is however not on the critical path
   * and the transition will continue straight away, rather than wait for the storage response
   * to be returned.
   *
   * If the storage response is asynchronous and write acknowledgement is enabled, the transition
   * will not be destroyed until writing to storage is finished
   */
</span>  if (!this._options.storageExclusion || !this._options.storageExclusion.test(this._name)) {
    this._storageResponses++
    this._options.storage.set(
      this._name,
      this._record,
      this._onStorageResponse.bind(this, this._currentStep)
    )
  }
  this._options.cache.set(
    this._name,
    this._record,
    this._onCacheResponse.bind(this, this._currentStep)
  )
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
     this._name,
     this._options,
     socketWrapper,
     this._onRecord.bind(this, update),
     this._onFatalError.bind(this)
   )
 } else if (this._steps.length === 1 &amp;&amp; this._cacheResponses === 1) {
   this.<span class="apidocCodeKeywordSpan">_next</span>()
 }
}

/**
* Destroys the instance
*
* @private
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype._onCacheResponse" id="apidoc.element.deepstream.io.record_transition.prototype._onCacheResponse">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_onCacheResponse
        <span class="apidocSignatureSpan">(currentStep, error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onCacheResponse = function (currentStep, error) {
  this._cacheResponses--
  this._writeError = this._writeError || error
  if (error) {
    this._onFatalError(error)
  } else if (this.isDestroyed === false) {
    this._recordHandler._$broadcastUpdate(
      this._name,
      this._currentStep.message,
      false,
      this._currentStep.sender
    )
    this._next()
  } else if (
      this._cacheResponses === 0 &amp;&amp;
      this._storageResponses === 0 &amp;&amp;
      this._steps.length === 0
    ) {
    this.destroy()
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype._onFatalError" id="apidoc.element.deepstream.io.record_transition.prototype._onFatalError">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_onFatalError
        <span class="apidocSignatureSpan">(errorMessage)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onFatalError = function (errorMessage) {
  if (this.isDestroyed === true) {
<span class="apidocCodeCommentSpan">    /* istanbul ignore next */
</span>    return
  }
  this._options.logger.log(C.LOG_LEVEL.ERROR, C.EVENT.RECORD_UPDATE_ERROR, errorMessage)

  for (let i = 0; i &lt; this._steps.length; i++) {
    if (this._steps[i].sender !== C.SOURCE_MESSAGE_CONNECTOR) {
      this._steps[i].sender.sendError(
        C.TOPIC.RECORD,
        C.EVENT.RECORD_UPDATE_ERROR,
        this._steps[i].version
      )
    }
  }

  if (this._cacheResponses === 0 &amp;&amp; this._storageResponses === 0) {
    this.destroy(errorMessage)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param   {Object} record
 *
 * @private
 * @returns {void}
 */
RecordTransition.prototype._onRecord = function (step, record) {
  if (record === null &amp;&amp; !step.upsert) {
this.<span class="apidocCodeKeywordSpan">_onFatalError</span>(`Received update for non-existant record ${this._name}`)
  } else if (record === null &amp;&amp; step.upsert) {
const emptyRecord = {
  _v: 0,
  _d: {}
}

this._recordHandler._permissionAction(
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype._onRecord" id="apidoc.element.deepstream.io.record_transition.prototype._onRecord">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_onRecord
        <span class="apidocSignatureSpan">(step, record)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onRecord = function (step, record) {
  if (record === null &amp;&amp; !step.upsert) {
    this._onFatalError(`Received update for non-existant record ${this._name}`)
  } else if (record === null &amp;&amp; step.upsert) {
    const emptyRecord = {
      _v: 0,
      _d: {}
    }

    this._recordHandler._permissionAction(
      C.ACTIONS.CREATE,
      this._name,
      step.sender,
      this._processRecord.bind(this, emptyRecord)
    )
  } else {
    this._processRecord(record)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype._onStorageResponse" id="apidoc.element.deepstream.io.record_transition.prototype._onStorageResponse">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_onStorageResponse
        <span class="apidocSignatureSpan">(currentStep, error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onStorageResponse = function (currentStep, error) {
  this._storageResponses--
  this._writeError = this._writeError || error
  if (error) {
    this._onFatalError(error)
  } else if (
      this._cacheResponses === 0 &amp;&amp;
      this._storageResponses === 0 &amp;&amp;
      this._steps.length === 0
    ) {
    this.destroy()
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype._processRecord" id="apidoc.element.deepstream.io.record_transition.prototype._processRecord">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_processRecord
        <span class="apidocSignatureSpan">(record)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_processRecord = function (record) {
  this._record = record
  this._flushVersionExists()
  this._next()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   this._recordHandler._permissionAction(
     C.ACTIONS.CREATE,
     this._name,
     step.sender,
     this._processRecord.bind(this, emptyRecord)
   )
 } else {
   this.<span class="apidocCodeKeywordSpan">_processRecord</span>(record)
 }
}

/**
* Callback used to process next update after record successfully returned or permissiom
* check passed
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype._sendWriteAcknowledgements" id="apidoc.element.deepstream.io.record_transition.prototype._sendWriteAcknowledgements">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>_sendWriteAcknowledgements
        <span class="apidocSignatureSpan">(errorMessage)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_sendWriteAcknowledgements = function (errorMessage) {
  errorMessage = errorMessage === undefined ? null : errorMessage // eslint-disable-line
  for (const uid in this._pendingUpdates) {
    const update = this._pendingUpdates[uid]

    update.socketWrapper.sendMessage(C.TOPIC.RECORD, C.ACTIONS.WRITE_ACKNOWLEDGEMENT, [
      this._name,
      update.versions,
      messageBuilder.typed(errorMessage)
    ])
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @returns {void}
 */
RecordTransition.prototype.destroy = function (errorMessage) {
if (this.isDestroyed) {
  return
}

this.<span class="apidocCodeKeywordSpan">_sendWriteAcknowledgements</span>(errorMessage || this._writeError)
this._recordHandler._$transitionComplete(this._name)
this.isDestroyed = true
this._options = null
this._name = null
this._record = null
this._recordHandler = null
this._steps = null
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype.add" id="apidoc.element.deepstream.io.record_transition.prototype.add">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>add
        <span class="apidocSignatureSpan">(socketWrapper, version, message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function (socketWrapper, version, message) {
  const update = {
    message,
    version,
    upsert: false,
    sender: socketWrapper
  }
  let data

  try {
    const config = RecordTransition._getRecordConfig(message)
    this._applyConfig(config, update)
  } catch (e) {
    update.sender.sendError(
      C.TOPIC.RECORD,
      C.EVENT.INVALID_CONFIG_DATA,
      message.data[4] || message.data[3]
    )
    return
  }

  if (message.action === C.ACTIONS.UPDATE) {
    if (message.data.length !== 4 &amp;&amp; message.data.length !== 3) {
      socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.INVALID_MESSAGE_DATA, message.raw)
      return
    }

    try {
      data = JSON.parse(message.data[2])
    } catch (e) {
      socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.INVALID_MESSAGE_DATA, message.raw)
      return
    }

    if (!utils.isOfType(data, 'object') &amp;&amp; !utils.isOfType(data, 'array')) {
      socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.INVALID_MESSAGE_DATA, message.raw)
      return
    }

    update.isPatch = false
    update.data = data
  }

  if (message.action === C.ACTIONS.PATCH) {
    if (message.data.length !== 5 &amp;&amp; message.data.length !== 4) {
      socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.INVALID_MESSAGE_DATA, message.raw)
      return
    }

    update.isPatch = true
    update.data = messageParser.convertTyped(message.data[3])

    if (update.data instanceof Error) {
      socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.INVALID_MESSAGE_DATA, `${update.data.toString()}:${message.data[3]}`)
      return
    }

    update.path = message.data[2]
  }

  if (this._lastVersion !== null &amp;&amp; this._lastVersion !== version - 1) {
    this.sendVersionExists(update)
    return
  }

  if (version !== -1) {
    this._lastVersion = version
  }
  this._cacheResponses++
  this._steps.push(update)

  if (this._recordRequest === null) {
    this._recordRequest = new RecordRequest(
      this._name,
      this._options,
      socketWrapper,
      this._onRecord.bind(this, update),
      this._onFatalError.bind(this)
    )
  } else if (this._steps.length === 1 &amp;&amp; this._cacheResponses === 1) {
    this._next()
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  this._locallyProvidedRecords[subscriptionName] = {
    socketWrapper,
    pattern: message.data[0],
    closeListener: this._removeListener.bind(this, socketWrapper, message)
  }
  socketWrapper.once('close', this._locallyProvidedRecords[subscriptionName].closeListener)
  this._clusterProvidedRecords.<span class="apidocCodeKeywordSpan">add</span>(subscriptionName)

  this._stopLocalDiscoveryStage(subscriptionName)
}

/**
* Register a client as a listener for record subscriptions
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype.destroy" id="apidoc.element.deepstream.io.record_transition.prototype.destroy">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>destroy
        <span class="apidocSignatureSpan">(errorMessage)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">destroy = function (errorMessage) {
  if (this.isDestroyed) {
    return
  }

  this._sendWriteAcknowledgements(errorMessage || this._writeError)
  this._recordHandler._$transitionComplete(this._name)
  this.isDestroyed = true
  this._options = null
  this._name = null
  this._record = null
  this._recordHandler = null
  this._steps = null
  this._currentStep = null
  this._recordRequest = null
  this._pendingUpdates = null
  this._lastVersion = null
  this._cacheResponses = 0
  this._storageResponses = 0
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

const msg = messageParser.parse(connectionMessage)[0]

if (msg === null || msg === undefined) {
  this._options.logger.log(C.LOG_LEVEL.WARN, C.EVENT.MESSAGE_PARSE_ERROR, connectionMessage)
  socketWrapper.sendError(C.TOPIC.CONNECTION, C.EVENT.MESSAGE_PARSE_ERROR, connectionMessage)
  socketWrapper.<span class="apidocCodeKeywordSpan">destroy</span>()
} else if (msg.topic !== C.TOPIC.CONNECTION) {
  this._options.logger.log(C.LOG_LEVEL.WARN, C.EVENT.INVALID_MESSAGE, `invalid connection message ${connectionMessage}`)
  socketWrapper.sendError(C.TOPIC.CONNECTION, C.EVENT.INVALID_MESSAGE, 'invalid connection message')
} else if (msg.action === C.ACTIONS.PONG) {
  // do nothing
} else if (msg.action === C.ACTIONS.CHALLENGE_RESPONSE) {
  socketWrapper.socket.removeListener('message', socketWrapper.connectionCallback)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype.hasVersion" id="apidoc.element.deepstream.io.record_transition.prototype.hasVersion">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>hasVersion
        <span class="apidocSignatureSpan">(version)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasVersion = function (version) {
  return version !== -1 &amp;&amp; version &lt;= this._lastVersion
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

if (isNaN(version)) {
  socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.INVALID_VERSION, [recordName, version])
  return
}

if (this._transitions[recordName] &amp;&amp; this._transitions[recordName].<span class="apidocCodeKeywordSpan">hasVersion</span>(version)) {
  this._transitions[recordName].sendVersionExists({ message, version, sender: socketWrapper })
  return
}

if (!this._transitions[recordName]) {
  this._transitions[recordName] = new RecordTransition(recordName, this._options, this)
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.record_transition.prototype.sendVersionExists" id="apidoc.element.deepstream.io.record_transition.prototype.sendVersionExists">
        function <span class="apidocSignatureSpan">deepstream.io.record_transition.prototype.</span>sendVersionExists
        <span class="apidocSignatureSpan">(step)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendVersionExists = function (step) {
  const socketWrapper = step.sender
  const version = step.version
  const config = step.message.data[4]

  if (this._record) {
    const data = config === undefined
    ? [this._name, this._record._v, JSON.stringify(this._record._d)]
    : [this._name, this._record._v, JSON.stringify(this._record._d), config]
    socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.VERSION_EXISTS, data)

    const msg = `${socketWrapper.user} tried to update record ${this._name} to version ${version} but it already was ${this._record
._v}`
    this._options.logger.log(C.LOG_LEVEL.WARN, C.EVENT.VERSION_EXISTS, msg)
  } else {
    this._sendVersionExists.push({
      version,
      sender: socketWrapper,
      config,
      message: step.message
    })
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if (isNaN(version)) {
  socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.INVALID_VERSION, [recordName, version])
  return
}

if (this._transitions[recordName] &amp;&amp; this._transitions[recordName].hasVersion(version)) {
  this._transitions[recordName].<span class="apidocCodeKeywordSpan">sendVersionExists</span>({ message, version, sender: socketWrapper
 })
  return
}

if (!this._transitions[recordName]) {
  this._transitions[recordName] = new RecordTransition(recordName, this._options, this)
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.rule_application" id="apidoc.module.deepstream.io.rule_application">module deepstream.io.rule_application</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.rule_application" id="apidoc.element.deepstream.io.rule_application.rule_application">
        function <span class="apidocSignatureSpan">deepstream.io.</span>rule_application
        <span class="apidocSignatureSpan">(params)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rule_application = function (params) {
  this._params = params
  this._isDestroyed = false
  this._runScheduled = false
  this._maxIterationCount = this._params.permissionOptions.maxRuleIterations
  this._crossReferenceFn = this._crossReference.bind(this)
  this._pathVars = this._getPathVars()
  this._user = this._getUser()
  this._recordData = {}
  this._id = Math.random().toString()
  this._iterations = 0
  this._run()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.rule_application.prototype" id="apidoc.module.deepstream.io.rule_application.prototype">module deepstream.io.rule_application.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._createNewRecordRequest" id="apidoc.element.deepstream.io.rule_application.prototype._createNewRecordRequest">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_createNewRecordRequest
        <span class="apidocSignatureSpan">(recordName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_createNewRecordRequest = function (recordName) {
  // eslint-disable-next-line
  new RecordRequest(
    recordName,
    this._params.options,
    null,
    this._onLoadComplete.bind(this, recordName),
    this._onLoadError.bind(this, recordName)
  )
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._crossReference" id="apidoc.element.deepstream.io.rule_application.prototype._crossReference">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_crossReference
        <span class="apidocSignatureSpan">(recordName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_crossReference = function (recordName) {
  const type = typeof recordName

  if (type !== UNDEFINED &amp;&amp; type !== STRING) {
    this._onRuleError(`crossreference got unsupported type ${type}`)
  } else if (type === UNDEFINED || recordName.indexOf(UNDEFINED) !== -1) {
    return
  } else if (this._recordData[recordName] === LOADING) {
    return
  } else if (this._recordData[recordName] === null) {
    return null
  } else if (typeof this._recordData[recordName] === UNDEFINED) {
    this._loadRecord(recordName)
  } else {
    return this._recordData[recordName]._d
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._destroy" id="apidoc.element.deepstream.io.rule_application.prototype._destroy">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_destroy
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_destroy = function () {
  this._params.recordHandler.removeRecordRequest(this._params.name)
  this._isDestroyed = true
  this._runScheduled = false
  this._params = null
  this._crossReferenceFn = null
  this._pathVars = null
  this._user = null
  this._recordData = null
  this._currentData = null
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   * @private
   * @returns {void}
   */
  _onComplete (error, response) {
if (error) {
  this._logger.log(C.LOG_LEVEL.WARN, C.EVENT.AUTH_ERROR, `http auth error: ${error}`)
  this._callback(false, null)
  this.<span class="apidocCodeKeywordSpan">_destroy</span>()
  return
}

if (response.statusCode &gt;= 500 &amp;&amp; response.statusCode &lt; 600) {
  this._logger.log(C.LOG_LEVEL.WARN, C.EVENT.AUTH_ERROR, `http auth server error: ${response.body}`)
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._getArguments" id="apidoc.element.deepstream.io.rule_application.prototype._getArguments">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getArguments
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getArguments = function () {
  return [
    this._crossReferenceFn,
    this._user,
    this._getCurrentData(),
    this._getOldData(),
    Date.now(),
    this._params ? this._params.action : null
  ].concat(this._pathVars)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

if (this._iterations &gt; this._maxIterationCount) {
  this._onRuleError('Exceeded max iteration count')
  return
}

const args = this.<span class="apidocCodeKeywordSpan">_getArguments</span>()
let result

if (this._isDestroyed === true) {
  return
}

try {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._getCurrentData" id="apidoc.element.deepstream.io.rule_application.prototype._getCurrentData">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getCurrentData
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getCurrentData = function () {
  if (this._params.rule.hasData === false) {
    return null
  }

  const msg = this._params.message
  let data

  if (msg.topic === C.TOPIC.EVENT &amp;&amp; msg.data[1]) {
    data = messageParser.convertTyped(msg.data[1])
  } else if (msg.topic === C.TOPIC.RPC) {
    data = messageParser.convertTyped(msg.data[2])
  } else if (msg.topic === C.TOPIC.RECORD &amp;&amp; msg.action === C.ACTIONS.UPDATE) {
    data = this._getRecordUpdateData(msg)
  } else if (msg.topic === C.TOPIC.RECORD &amp;&amp; msg.action === C.ACTIONS.PATCH) {
    data = this._getRecordPatchData(msg)
  }

  if (data instanceof Error) {
    this._onRuleError(`error when converting message data ${data.toString()}`)
  } else {
    return data
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @private
 * @returns {void}
 */
RuleApplication.prototype._getArguments = function () {
  return [
    this._crossReferenceFn,
    this._user,
    this.<span class="apidocCodeKeywordSpan">_getCurrentData</span>(),
    this._getOldData(),
    Date.now(),
    this._params ? this._params.action : null
  ].concat(this._pathVars)
}

/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._getOldData" id="apidoc.element.deepstream.io.rule_application.prototype._getOldData">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getOldData
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getOldData = function () {
  if (this._isDestroyed === true || this._params.rule.hasOldData === false) {
    return null
  } else if (this._recordData[this._params.name]) {
    return this._recordData[this._params.name]._d
  }
  this._loadRecord(this._params.name)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @returns {void}
*/
RuleApplication.prototype._getArguments = function () {
 return [
   this._crossReferenceFn,
   this._user,
   this._getCurrentData(),
   this.<span class="apidocCodeKeywordSpan">_getOldData</span>(),
   Date.now(),
   this._params ? this._params.action : null
 ].concat(this._pathVars)
}

/**
* Returns the data for the user variable. This is only done once
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._getPathVars" id="apidoc.element.deepstream.io.rule_application.prototype._getPathVars">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getPathVars
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getPathVars = function () {
  return this._params.name.match(this._params.regexp).slice(1)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
const RuleApplication = function (params) {
  this._params = params
  this._isDestroyed = false
  this._runScheduled = false
  this._maxIterationCount = this._params.permissionOptions.maxRuleIterations
  this._crossReferenceFn = this._crossReference.bind(this)
  this._pathVars = this.<span class="apidocCodeKeywordSpan">_getPathVars</span>()
  this._user = this._getUser()
  this._recordData = {}
  this._id = Math.random().toString()
  this._iterations = 0
  this._run()
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._getRecordPatchData" id="apidoc.element.deepstream.io.rule_application.prototype._getRecordPatchData">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getRecordPatchData
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getRecordPatchData = function (msg) {
  if (msg.data.length !== 4 || typeof msg.data[2] !== STRING) {
    return new Error('Invalid message data')
  }

  const currentData = this._recordData[this._params.name]
  const newData = messageParser.convertTyped(msg.data[3])
  let jsonPath
  let data

  if (newData instanceof Error) {
    return newData
  }

  if (currentData === null) {
    return new Error(`Tried to apply patch to non-existant record ${msg.data[0]}`)
  }

  if (typeof currentData !== UNDEFINED &amp;&amp; currentData !== LOADING) {
    jsonPath = new JsonPath(msg.data[2])
    data = JSON.parse(JSON.stringify(currentData._d))
    jsonPath.setValue(data, newData)
    return data
  }
  this._loadRecord(this._params.name)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (msg.topic === C.TOPIC.EVENT &amp;&amp; msg.data[1]) {
  data = messageParser.convertTyped(msg.data[1])
} else if (msg.topic === C.TOPIC.RPC) {
  data = messageParser.convertTyped(msg.data[2])
} else if (msg.topic === C.TOPIC.RECORD &amp;&amp; msg.action === C.ACTIONS.UPDATE) {
  data = this._getRecordUpdateData(msg)
} else if (msg.topic === C.TOPIC.RECORD &amp;&amp; msg.action === C.ACTIONS.PATCH) {
  data = this.<span class="apidocCodeKeywordSpan">_getRecordPatchData</span>(msg)
}

if (data instanceof Error) {
  this._onRuleError(`error when converting message data ${data.toString()}`)
} else {
  return data
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._getRecordUpdateData" id="apidoc.element.deepstream.io.rule_application.prototype._getRecordUpdateData">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getRecordUpdateData
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getRecordUpdateData = function (msg) {
  let data

  try {
    data = JSON.parse(msg.data[2])
  } catch (error) {
    return error
  }

  return data
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
let data

if (msg.topic === C.TOPIC.EVENT &amp;&amp; msg.data[1]) {
  data = messageParser.convertTyped(msg.data[1])
} else if (msg.topic === C.TOPIC.RPC) {
  data = messageParser.convertTyped(msg.data[2])
} else if (msg.topic === C.TOPIC.RECORD &amp;&amp; msg.action === C.ACTIONS.UPDATE) {
  data = this.<span class="apidocCodeKeywordSpan">_getRecordUpdateData</span>(msg)
} else if (msg.topic === C.TOPIC.RECORD &amp;&amp; msg.action === C.ACTIONS.PATCH) {
  data = this._getRecordPatchData(msg)
}

if (data instanceof Error) {
  this._onRuleError(`error when converting message data ${data.toString()}`)
} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._getUser" id="apidoc.element.deepstream.io.rule_application.prototype._getUser">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_getUser
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getUser = function () {
  return {
    isAuthenticated: this._params.username !== OPEN,
    id: this._params.username,
    data: this._params.authData
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
const RuleApplication = function (params) {
  this._params = params
  this._isDestroyed = false
  this._runScheduled = false
  this._maxIterationCount = this._params.permissionOptions.maxRuleIterations
  this._crossReferenceFn = this._crossReference.bind(this)
  this._pathVars = this._getPathVars()
  this._user = this.<span class="apidocCodeKeywordSpan">_getUser</span>()
  this._recordData = {}
  this._id = Math.random().toString()
  this._iterations = 0
  this._run()
}

/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._isReady" id="apidoc.element.deepstream.io.rule_application.prototype._isReady">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_isReady
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_isReady = function () {
  let isLoading = false

  for (const key in this._recordData) {
    if (this._recordData[key] === LOADING) {
      isLoading = true
    }
  }

  return isLoading === false &amp;&amp; this._runScheduled === false
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (this._isDestroyed === true) {
  return
}

try {
  result = this._params.rule.fn.apply({}, args)
} catch (error) {
  if (this.<span class="apidocCodeKeywordSpan">_isReady</span>()) {
    this._onRuleError(error)
    return
  }
}

if (this._isReady()) {
  this._params.callback(null, result)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._loadRecord" id="apidoc.element.deepstream.io.rule_application.prototype._loadRecord">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_loadRecord
        <span class="apidocSignatureSpan">(recordName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_loadRecord = function (recordName) {
<span class="apidocCodeCommentSpan">  /* istanbul ignore next */
</span>  if (this._recordData[recordName] === LOADING) {
    return
  }
  /* istanbul ignore next */
  if (typeof this._recordData[recordName] !== UNDEFINED) {
    this._onLoadComplete(recordName, this._recordData[recordName])
    return
  }

  this._recordData[recordName] = LOADING

  this._params.recordHandler.runWhenRecordStable(
    recordName,
    this._createNewRecordRequest.bind(this)
  )
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

 if (typeof currentData !== UNDEFINED &amp;&amp; currentData !== LOADING) {
   jsonPath = new JsonPath(msg.data[2])
   data = JSON.parse(JSON.stringify(currentData._d))
   jsonPath.setValue(data, newData)
   return data
 }
 this.<span class="apidocCodeKeywordSpan">_loadRecord</span>(this._params.name)
}

/**
* Returns or loads the record's previous value. Only supported for record
* write and read operations
*
* If getData encounters an error, the rule application might already be destroyed
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._onLoadComplete" id="apidoc.element.deepstream.io.rule_application.prototype._onLoadComplete">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_onLoadComplete
        <span class="apidocSignatureSpan">(recordName, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onLoadComplete = function (recordName, data) {
  this._recordData[recordName] = data

  if (this._isReady()) {
    this._runScheduled = true
    process.nextTick(this._run.bind(this))
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
RuleApplication.prototype._loadRecord = function (recordName) {
/* istanbul ignore next */
if (this._recordData[recordName] === LOADING) {
  return
}
/* istanbul ignore next */
if (typeof this._recordData[recordName] !== UNDEFINED) {
  this.<span class="apidocCodeKeywordSpan">_onLoadComplete</span>(recordName, this._recordData[recordName])
  return
}

this._recordData[recordName] = LOADING

this._params.recordHandler.runWhenRecordStable(
  recordName,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._onLoadError" id="apidoc.element.deepstream.io.rule_application.prototype._onLoadError">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_onLoadError
        <span class="apidocSignatureSpan">(recordName, error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onLoadError = function (recordName, error) {
  this._recordData[recordName] = ERROR
  const errorMsg = `failed to load record ${this._params.name} for permissioning:${error.toString()}`
  this._params.logger.log(C.LOG_LEVEL.ERROR, C.EVENT.RECORD_LOAD_ERROR, errorMsg)
  this._params.callback(C.EVENT.RECORD_LOAD_ERROR, false)
  this._destroy()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._onRuleError" id="apidoc.element.deepstream.io.rule_application.prototype._onRuleError">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_onRuleError
        <span class="apidocSignatureSpan">(error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onRuleError = function (error) {
  if (this._isDestroyed === true) {
    return
  }
  const errorMsg = `error when executing ${this._params.rule.fn.toString()}${EOL
           }for ${this._params.path}: ${error.toString()}`
  this._params.logger.log(C.LOG_LEVEL.WARN, C.EVENT.MESSAGE_PERMISSION_ERROR, errorMsg)
  this._params.callback(C.EVENT.MESSAGE_PERMISSION_ERROR, false)
  this._destroy()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this._iterations++
/* istanbul ignore next */
if (this._isDestroyed === true) {
  return
}

if (this._iterations &gt; this._maxIterationCount) {
  this.<span class="apidocCodeKeywordSpan">_onRuleError</span>('Exceeded max iteration count')
  return
}

const args = this._getArguments()
let result

if (this._isDestroyed === true) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_application.prototype._run" id="apidoc.element.deepstream.io.rule_application.prototype._run">
        function <span class="apidocSignatureSpan">deepstream.io.rule_application.prototype.</span>_run
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_run = function () {
  this._runScheduled = false
  this._iterations++
<span class="apidocCodeCommentSpan">  /* istanbul ignore next */
</span>  if (this._isDestroyed === true) {
    return
  }

  if (this._iterations &gt; this._maxIterationCount) {
    this._onRuleError('Exceeded max iteration count')
    return
  }

  const args = this._getArguments()
  let result

  if (this._isDestroyed === true) {
    return
  }

  try {
    result = this._params.rule.fn.apply({}, args)
  } catch (error) {
    if (this._isReady()) {
      this._onRuleError(error)
      return
    }
  }

  if (this._isReady()) {
    this._params.callback(null, result)
    this._destroy()
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 this._maxIterationCount = this._params.permissionOptions.maxRuleIterations
 this._crossReferenceFn = this._crossReference.bind(this)
 this._pathVars = this._getPathVars()
 this._user = this._getUser()
 this._recordData = {}
 this._id = Math.random().toString()
 this._iterations = 0
 this.<span class="apidocCodeKeywordSpan">_run</span>()
}

/**
* Runs the rule function. This method is initially called when this class
* is constructed and recoursively from thereon whenever the loading of a record
* is completed
*
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.rule_cache" id="apidoc.module.deepstream.io.rule_cache">module deepstream.io.rule_cache</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.rule_cache.rule_cache" id="apidoc.element.deepstream.io.rule_cache.rule_cache">
        function <span class="apidocSignatureSpan">deepstream.io.</span>rule_cache
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rule_cache = function (options) {
  this._options = options
  this._data = {}
  setInterval(this._purge.bind(this), options.cacheEvacuationInterval)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.rule_cache.prototype" id="apidoc.module.deepstream.io.rule_cache.prototype">module deepstream.io.rule_cache.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.rule_cache.prototype._purge" id="apidoc.element.deepstream.io.rule_cache.prototype._purge">
        function <span class="apidocSignatureSpan">deepstream.io.rule_cache.prototype.</span>_purge
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_purge = function () {
  for (const key in this._data) {
    if (this._data[key].isUsed === true) {
      this._data[key].isUsed = false
    } else {
      delete this._data[key]
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_cache.prototype._toKey" id="apidoc.element.deepstream.io.rule_cache.prototype._toKey">
        function <span class="apidocSignatureSpan">deepstream.io.rule_cache.prototype.</span>_toKey
        <span class="apidocSignatureSpan">(section, name, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_toKey = function (section, name, type) {
  return `${section}_${name}_${type}`
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param   {String}  name    the name of the record, event or rpc
* @param   {String}  type    the type of the action, e.g. read, write, subscribe
*
* @public
* @returns {Boolean}
*/
RuleCache.prototype.has = function (section, name, type) {
 return !!this._data[this.<span class="apidocCodeKeywordSpan">_toKey</span>(section, name, type)]
}

/**
* Resets the usage flag and returns an entry from the cache
*
* @param   {String}  section e.g. record, event or rpc
* @param   {String}  name    the name of the record, event or rpc
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_cache.prototype.get" id="apidoc.element.deepstream.io.rule_cache.prototype.get">
        function <span class="apidocSignatureSpan">deepstream.io.rule_cache.prototype.</span>get
        <span class="apidocSignatureSpan">(section, name, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (section, name, type) {
  const key = this._toKey(section, name, type)
  this._data[key].isUsed = true
  return this._data[key].rule
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 *
 * @param  {String}   urlPath URL where to download the archive
 * @param  {Stream}   writeable output stream to save the archive
 * @param  {Function} callback Callback (err)
 * @return {void}
 */
const downloadArchive = function (urlPath, outStream, callback) {
needle.<span class="apidocCodeKeywordSpan">get</span>(`https://github.com${urlPath}`, {
  follow_max: 5,
  headers: { 'User-Agent': 'nodejs-client' }
}, (error, response) =&gt; {
  if (error) {
    return callback(error)
  }
  outStream.write(response.body)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_cache.prototype.has" id="apidoc.element.deepstream.io.rule_cache.prototype.has">
        function <span class="apidocSignatureSpan">deepstream.io.rule_cache.prototype.</span>has
        <span class="apidocSignatureSpan">(section, name, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">has = function (section, name, type) {
  return !!this._data[this._toKey(section, name, type)]
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Used primarily for tests. Returns whether or not a provider exists for
* the specific subscriptionName
* @public
* @returns {boolean}
*/
hasActiveProvider (susbcriptionName) {
  return this._clusterProvidedRecords.<span class="apidocCodeKeywordSpan">has</span>(susbcriptionName)
}

/**
* The main entry point to the handle class.
* Called on any of the following actions:
*
* 1) C.ACTIONS.LISTEN
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_cache.prototype.reset" id="apidoc.element.deepstream.io.rule_cache.prototype.reset">
        function <span class="apidocSignatureSpan">deepstream.io.rule_cache.prototype.</span>reset
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reset = function () {
  this._data = {}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

 if (validationResult !== true) {
   this.emit('error', `invalid permission config - ${validationResult}`)
   return
 }

 this._config = configCompiler.compile(config)
 this._ruleCache.<span class="apidocCodeKeywordSpan">reset</span>()
 this._ready()
}

/**
* Implements the permissionHandler's canPerformAction interface
* method
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_cache.prototype.set" id="apidoc.element.deepstream.io.rule_cache.prototype.set">
        function <span class="apidocSignatureSpan">deepstream.io.rule_cache.prototype.</span>set
        <span class="apidocSignatureSpan">(section, name, type, rule)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">set = function (section, name, type, rule) {
  this._data[this._toKey(section, name, type)] = {
    rule,
    isUsed: true
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
ConfigPermissionHandler.prototype.setRecordHandler = function (recordHandler) {
this._recordHandler = recordHandler
}

/**
 * Will be called by the dependency initialiser once server.start() is called.
 * This gives users a chance to change the path using server.<span class="apidocCodeKeywordSpan">set</span>()
 * first
 *
 * @public
 * @returns {void}
 */
ConfigPermissionHandler.prototype.init = function () {
if (this._config === null &amp;&amp; this._optionsValid) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.rule_parser" id="apidoc.module.deepstream.io.rule_parser">module deepstream.io.rule_parser</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.rule_parser.parse" id="apidoc.element.deepstream.io.rule_parser.parse">
        function <span class="apidocSignatureSpan">deepstream.io.rule_parser.</span>parse
        <span class="apidocSignatureSpan">(rule, variables)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parse = function (rule, variables) {
  if (rule === true || rule === false) {
    return {
      fn: rule === true ? function () { return true } : function () { return false },
      hasOldData: false,
      hasData: false
    }
  }
  const ruleObj = {}
  const args = ['_', 'user', 'data', 'oldData', 'now', 'action'].concat(variables)
  args.push(`return ${rule};`)

  ruleObj.fn = Function.apply(this, args)
  ruleObj.hasOldData = !!rule.match(OLD_DATA_REGEXP)
  ruleObj.hasData = !!rule.match(DATA_REGEXP)

  return ruleObj
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

function fetchLibs(libDir, meta) {
  const directory = libDir || 'lib'
  const files = glob.sync(path.join(directory, '*', 'package.json'))
  meta.libs = files.map((filePath) =&gt; {
    const pkg = fs.readFileSync(filePath, 'utf8')
    const object = JSON.<span class="apidocCodeKeywordSpan">parse</span>(pkg)
    return `${object.name}:${object.version}`
  })
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rule_parser.validate" id="apidoc.element.deepstream.io.rule_parser.validate">
        function <span class="apidocSignatureSpan">deepstream.io.rule_parser.</span>validate
        <span class="apidocSignatureSpan">(rule, section, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validate = function (rule, section, type) {
  if (typeof rule === 'boolean') {
    return true
  }

  if (typeof rule !== 'string') {
    return 'rule must be a string'
  }

  if (rule.length === 0) {
    return 'rule can\'t be empty'
  }

  if (rule.match(NEW_REGEXP)) {
    return 'rule can\'t contain the new keyword'
  }

  if (rule.match(USER_FUNCTION_REGEXP)) {
    return 'rule can\'t contain user functions'
  }

  const functions = rule.match(FUNCTION_REGEXP)
  let functionName
  let i

  // TODO _ cross references are only supported for section record
  if (functions) {
    for (i = 0; i &lt; functions.length; i++) {
      functionName = functions[i].replace(/\s*\($/, '')
      if (SUPPORTED_FUNCTIONS.indexOf(functionName) === -1) {
        return `function ${functionName} is not supported`
      }
    }
  }

  try {
    // eslint-disable-next-line
    new Function(rule)
  } catch (e) {
    return e.toString()
  }

  if (!!rule.match(OLD_DATA_REGEXP) &amp;&amp; !rulesMap.supportsOldData(type)) {
    return `rule ${type} for ${section} does not support oldData`
  }

  if (!!rule.match(DATA_REGEXP) &amp;&amp; !rulesMap.supportsData(type)) {
    return `rule ${type} for ${section} does not support data`
  }

  return true
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 *
 * @param   {Object} config deepstream permissionConfig
 *
 * @public
 * @returns {void}
 */
ConfigPermissionHandler.prototype.useConfig = function (config) {
const validationResult = configValidator.<span class="apidocCodeKeywordSpan">validate</span>(config)

if (validationResult !== true) {
  this.emit('error', `invalid permission config - ${validationResult}`)
  return
}

this._config = configCompiler.compile(config)
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.rules_map" id="apidoc.module.deepstream.io.rules_map">module deepstream.io.rules_map</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.rules_map.getRulesForMessage" id="apidoc.element.deepstream.io.rules_map.getRulesForMessage">
        function <span class="apidocSignatureSpan">deepstream.io.rules_map.</span>getRulesForMessage
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRulesForMessage = function (message) {
  if (RULES_MAP[message.topic] === undefined) {
    return null
  }

  if (RULES_MAP[message.topic].actions[message.action] === undefined) {
    return null
  }

  return {
    section: RULES_MAP[message.topic].section,
    type: RULES_MAP[message.topic].actions[message.action].name,
    action: actionToKey[message.action]
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
ConfigPermissionHandler.prototype.canPerformAction = function (
username, message, callback, authData) {
if (typeof message.data[0] !== STRING) {
  callback('invalid message', false)
  return
}

const ruleSpecification = rulesMap.<span class="apidocCodeKeywordSpan">getRulesForMessage</span>(message)
const name = message.data[0]

if (ruleSpecification === null) {
  callback(null, true)
  return
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rules_map.supportsData" id="apidoc.element.deepstream.io.rules_map.supportsData">
        function <span class="apidocSignatureSpan">deepstream.io.rules_map.</span>supportsData
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">supportsData = function (type) {
  return RULE_TYPES[type.toUpperCase()].data
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return e.toString()
  }

  if (!!rule.match(OLD_DATA_REGEXP) &amp;&amp; !rulesMap.supportsOldData(type)) {
    return `rule ${type} for ${section} does not support oldData`
  }

  if (!!rule.match(DATA_REGEXP) &amp;&amp; !rulesMap.<span class="apidocCodeKeywordSpan">supportsData</span>(type)) {
    return `rule ${type} for ${section} does not support data`
  }

  return true
}

/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.rules_map.supportsOldData" id="apidoc.element.deepstream.io.rules_map.supportsOldData">
        function <span class="apidocSignatureSpan">deepstream.io.rules_map.</span>supportsOldData
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">supportsOldData = function (type) {
  return RULE_TYPES[type.toUpperCase()].oldData
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
try {
  // eslint-disable-next-line
  new Function(rule)
} catch (e) {
  return e.toString()
}

if (!!rule.match(OLD_DATA_REGEXP) &amp;&amp; !rulesMap.<span class="apidocCodeKeywordSpan">supportsOldData</span>(type)) {
  return `rule ${type} for ${section} does not support oldData`
}

if (!!rule.match(DATA_REGEXP) &amp;&amp; !rulesMap.supportsData(type)) {
  return `rule ${type} for ${section} does not support data`
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.socket_wrapper" id="apidoc.module.deepstream.io.socket_wrapper">module deepstream.io.socket_wrapper</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.socket_wrapper" id="apidoc.element.deepstream.io.socket_wrapper.socket_wrapper">
        function <span class="apidocSignatureSpan">deepstream.io.</span>socket_wrapper
        <span class="apidocSignatureSpan">(socket, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">socket_wrapper = function (socket, options) {
  this.socket = socket
  this.isClosed = false
  this.socket.once('close', this._onSocketClose.bind(this))
  this._options = options
  this.user = null
  this.authCallBack = null
  this.authAttempts = 0
  this.setMaxListeners(0)
  this.uuid = Math.random()
  this._handshakeData = null
  this._setUpHandshakeData()

  this._queuedMessages = []
  this._currentPacketMessageCount = 0
  this._sendNextPacketTimeout = null
  this._currentMessageResetTimeout = null
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.finalizeMessage" id="apidoc.element.deepstream.io.socket_wrapper.finalizeMessage">
        function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.</span>finalizeMessage
        <span class="apidocSignatureSpan">(preparedMessage)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">finalizeMessage = function (preparedMessage) {
  uws.native.server.finalizeMessage(preparedMessage)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*
* @param {External} preparedMessage the prepared message to finalize
*
* @public
* @returns {void}
*/
SocketWrapper.finalizeMessage = function (preparedMessage) {
 uws.native.server.<span class="apidocCodeKeywordSpan">finalizeMessage</span>(preparedMessage)
}

/**
* Returns a map of parameters that were collected
* during the initial http request that established the
* connection
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.prepareMessage" id="apidoc.element.deepstream.io.socket_wrapper.prepareMessage">
        function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.</span>prepareMessage
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">prepareMessage = function (message) {
  SocketWrapper.lastPreparedMessage = message
  return uws.native.server.prepareMessage(message, uws.OPCODE_TEXT)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param {String} message the message to be prepared
*
* @public
* @returns {External} prepared message
*/
SocketWrapper.prepareMessage = function (message) {
 SocketWrapper.lastPreparedMessage = message
 return uws.native.server.<span class="apidocCodeKeywordSpan">prepareMessage</span>(message, uws.OPCODE_TEXT)
}

/**
* Sends the [uws] prepared message, or in case of testing sends the
* last prepared message.
*
* @param {External} preparedMessage the prepared message
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.super_" id="apidoc.element.deepstream.io.socket_wrapper.super_">
        function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.socket_wrapper.prototype" id="apidoc.module.deepstream.io.socket_wrapper.prototype">module deepstream.io.socket_wrapper.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.prototype._onSocketClose" id="apidoc.element.deepstream.io.socket_wrapper.prototype._onSocketClose">
        function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>_onSocketClose
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onSocketClose = function () {
  this.isClosed = true
  this.emit('close', this)
  this._options.logger.log(C.LOG_LEVEL.INFO, C.EVENT.CLIENT_DISCONNECTED, this.user)
  this.socket.removeAllListeners()
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.prototype._setUpHandshakeData" id="apidoc.element.deepstream.io.socket_wrapper.prototype._setUpHandshakeData">
        function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>_setUpHandshakeData
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_setUpHandshakeData = function () {
  this._handshakeData = {
    remoteAddress: this.socket._socket.remoteAddress
  }

  if (this.socket.upgradeReq) {
    this._handshakeData.headers = this.socket.upgradeReq.headers
    this._handshakeData.referer = this.socket.upgradeReq.headers.referer
  }
  return this._handshakeData
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this._options = options
  this.user = null
  this.authCallBack = null
  this.authAttempts = 0
  this.setMaxListeners(0)
  this.uuid = Math.random()
  this._handshakeData = null
  this.<span class="apidocCodeKeywordSpan">_setUpHandshakeData</span>()

  this._queuedMessages = []
  this._currentPacketMessageCount = 0
  this._sendNextPacketTimeout = null
  this._currentMessageResetTimeout = null
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.prototype.destroy" id="apidoc.element.deepstream.io.socket_wrapper.prototype.destroy">
        function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>destroy
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">destroy = function () {
  this.socket.close()
  this.authCallBack = null
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

const msg = messageParser.parse(connectionMessage)[0]

if (msg === null || msg === undefined) {
  this._options.logger.log(C.LOG_LEVEL.WARN, C.EVENT.MESSAGE_PARSE_ERROR, connectionMessage)
  socketWrapper.sendError(C.TOPIC.CONNECTION, C.EVENT.MESSAGE_PARSE_ERROR, connectionMessage)
  socketWrapper.<span class="apidocCodeKeywordSpan">destroy</span>()
} else if (msg.topic !== C.TOPIC.CONNECTION) {
  this._options.logger.log(C.LOG_LEVEL.WARN, C.EVENT.INVALID_MESSAGE, `invalid connection message ${connectionMessage}`)
  socketWrapper.sendError(C.TOPIC.CONNECTION, C.EVENT.INVALID_MESSAGE, 'invalid connection message')
} else if (msg.action === C.ACTIONS.PONG) {
  // do nothing
} else if (msg.action === C.ACTIONS.CHALLENGE_RESPONSE) {
  socketWrapper.socket.removeListener('message', socketWrapper.connectionCallback)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.prototype.getHandshakeData" id="apidoc.element.deepstream.io.socket_wrapper.prototype.getHandshakeData">
        function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>getHandshakeData
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getHandshakeData = function () {
  return this._handshakeData
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   * @param {Websocket} socket
   *
   * @private
   * @returns {void}
   */
  _onConnection (socket) {
const socketWrapper = new SocketWrapper(socket, this._options)
const handshakeData = socketWrapper.<span class="apidocCodeKeywordSpan">getHandshakeData</span>()
const logMsg = `from ${handshakeData.referer} (${handshakeData.remoteAddress})`
let disconnectTimer

this._options.logger.log(C.LOG_LEVEL.INFO, C.EVENT.INCOMING_CONNECTION, logMsg)

if (this._options.unauthenticatedClientTimeout !== null) {
  disconnectTimer = setTimeout(
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.prototype.send" id="apidoc.element.deepstream.io.socket_wrapper.prototype.send">
        function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>send
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (message) {
  if (message.charAt(message.length - 1) !== C.MESSAGE_SEPERATOR) {
    message += C.MESSAGE_SEPERATOR // eslint-disable-line
  }

  if (this.isClosed === true) {
    return
  }

  this.socket.send(message)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param  {Boolean} hasProvider      send T or F so provided status
* @param  {SocketWrapper}  socketWrapper    the socket wrapper to send to,
*                                           if it doesn't exist then don't do anything
* @param  {String}  subscriptionName The subscription name which provided status changed
*/
_sendHasProviderUpdateToSingleSubscriber (hasProvider, socketWrapper, subscriptionName) {
  if (socketWrapper &amp;&amp; this._topic === C.TOPIC.RECORD) {
    socketWrapper.<span class="apidocCodeKeywordSpan">send</span>(this._createHasProviderMessage(hasProvider, this._topic, subscriptionName
))
  }
}

/**
* Sends a has provider update to all subcribers
* @param  {Boolean} hasProvider      send T or F so provided status
* @param  {String}  subscriptionName The subscription name which provided status changed
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.prototype.sendError" id="apidoc.element.deepstream.io.socket_wrapper.prototype.sendError">
        function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>sendError
        <span class="apidocSignatureSpan">(topic, type, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendError = function (topic, type, msg) {
  if (this.isClosed === false) {
    this.send(messageBuilder.getErrorMsg(topic, type, msg))
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   false,
   socket
 )
}

EventHandler.prototype._sendError = function (socket, event, message) {
 if (socket &amp;&amp; socket.sendError) {
   socket.<span class="apidocCodeKeywordSpan">sendError</span>(C.TOPIC.EVENT, event, message)
 }
 this._logger.log(C.LOG_LEVEL.ERROR, event, message)
}

/**
* Makes sure that subscription message contains the name of the event. Sends an error to the client
* if not
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.prototype.sendMessage" id="apidoc.element.deepstream.io.socket_wrapper.prototype.sendMessage">
        function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>sendMessage
        <span class="apidocSignatureSpan">(topic, action, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendMessage = function (topic, action, data) {
  if (this.isClosed === false) {
    this.send(messageBuilder.getMsg(topic, action, data))
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  socketWrapper.connectionCallback = this._processConnectionMessage.bind(this, socketWrapper)
  socketWrapper.authCallBack = this._authenticateConnection.bind(
    this,
    socketWrapper,
    disconnectTimer
  )
  socketWrapper.<span class="apidocCodeKeywordSpan">sendMessage</span>(C.TOPIC.CONNECTION, C.ACTIONS.CHALLENGE)
  socket.on('message', socketWrapper.connectionCallback)
}

/**
 * Always challenges the client that connects. This will be opened up later to allow users
 * to put in their own challenge authentication, but requires more work on the clustering
 * aspect first.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.prototype.sendNative" id="apidoc.element.deepstream.io.socket_wrapper.prototype.sendNative">
        function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>sendNative
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendNative = function (message) {
  this.socket.send(message)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  while (i &lt; gaps.length) {
    message += sharedMessages.substring(lastStop, gaps[i++])
    lastStop = gaps[i++]
  }
  message += sharedMessages.substring(lastStop, sharedMessages.length)

  if (message) {
    socket.<span class="apidocCodeKeywordSpan">sendNative</span>(message)
  }
}

// for all sockets in this subscription name, send either sharedMessage or this socket's
// specialized message. only sockets that sent something will have a special message, all
// other sockets are only listeners and receive the exact same (sharedMessage) message.
const sockets = this._subscriptions.get(name)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.socket_wrapper.prototype.sendPrepared" id="apidoc.element.deepstream.io.socket_wrapper.prototype.sendPrepared">
        function <span class="apidocSignatureSpan">deepstream.io.socket_wrapper.prototype.</span>sendPrepared
        <span class="apidocSignatureSpan">(preparedMessage)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendPrepared = function (preparedMessage) {
  if (this.socket.external) {
    uws.native.server.sendPrepared(this.socket.external, preparedMessage)
  } else if (this.socket.external !== null) {
    this.socket.send(SocketWrapper.lastPreparedMessage)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param {External} preparedMessage the prepared message
*
* @public
* @returns {void}
*/
SocketWrapper.prototype.sendPrepared = function (preparedMessage) {
 if (this.socket.external) {
   uws.native.server.<span class="apidocCodeKeywordSpan">sendPrepared</span>(this.socket.external, preparedMessage)
 } else if (this.socket.external !== null) {
   this.socket.send(SocketWrapper.lastPreparedMessage)
 }
}

/**
* Variant of send with no particular checks or appends of message.
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.std_out_logger" id="apidoc.module.deepstream.io.std_out_logger">module deepstream.io.std_out_logger</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.std_out_logger.std_out_logger" id="apidoc.element.deepstream.io.std_out_logger.std_out_logger">
        function <span class="apidocSignatureSpan">deepstream.io.</span>std_out_logger
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">std_out_logger = function (options) {
  this._options = options || {}
  this.isReady = true
  this._$useColors = this._options.colors === undefined ? true : this._options.colors
  this._logLevelColors = [
    'white',
    'green',
    'yellow',
    'red'
  ]

  this._currentLogLevel = C.LOG_LEVEL[this._options.logLevel] || C.LOG_LEVEL.DEBUG
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.std_out_logger.prototype" id="apidoc.module.deepstream.io.std_out_logger.prototype">module deepstream.io.std_out_logger.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.std_out_logger.prototype.log" id="apidoc.element.deepstream.io.std_out_logger.prototype.log">
        function <span class="apidocSignatureSpan">deepstream.io.std_out_logger.prototype.</span>log
        <span class="apidocSignatureSpan">(logLevel, event, logMessage)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">log = function (logLevel, event, logMessage) {
  if (logLevel &lt; this._currentLogLevel) {
    return
  }

  const msg = `${event} | ${logMessage}`
  let outputStream

  if (logLevel === C.LOG_LEVEL.ERROR || logLevel === C.LOG_LEVEL.WARN) {
    outputStream = 'stderr'
  } else {
    outputStream = 'stdout'
  }

  if (this._$useColors) {
    process[outputStream].write(msg[this._logLevelColors[logLevel]] + EOL)
  } else {
    process[outputStream].write(msg + EOL)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  const fileAuthenticationHandler = new FileAuthenticationHandler(config.auth.options)
  fileAuthenticationHandler.createHash(password, (err, hash) =&gt; {
    if (err) {
      console.error('Hash could not be created', err)
      process.exit(1)
    }
    console.<span class="apidocCodeKeywordSpan">log</span>('Password hash:', hash)
  })
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.std_out_logger.prototype.setLogLevel" id="apidoc.element.deepstream.io.std_out_logger.prototype.setLogLevel">
        function <span class="apidocSignatureSpan">deepstream.io.std_out_logger.prototype.</span>setLogLevel
        <span class="apidocSignatureSpan">(logLevel)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setLogLevel = function (logLevel) {
  this._currentLogLevel = logLevel
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 }

 config.logger = new Logger(configOptions)
 if (LOG_LEVEL_KEYS.indexOf(config.logLevel) !== -1) {
   // NOTE: config.logLevel has highest priority, compare to the level defined
   // in the nested logger object
   config.logLevel = C.LOG_LEVEL[config.logLevel]
   config.logger.<span class="apidocCodeKeywordSpan">setLogLevel</span>(config.logLevel)
 }
}

/**
* Handle the plugins property in the config object the connectors.
* Allowed types: {message|cache|storage}
* Plugins can be passed either as a __path__ property or as a __name__ property with
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.deepstream.io.utils" id="apidoc.module.deepstream.io.utils">module deepstream.io.utils</a></h1>


    <h2>
        <a href="#apidoc.element.deepstream.io.utils.combineEvents" id="apidoc.element.deepstream.io.utils.combineEvents">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>combineEvents
        <span class="apidocSignatureSpan">(emitters, event, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">combineEvents = function (emitters, event, callback) {
  let i
  let count = 0
  const increment = function () {
    count++

    if (count === emitters.length) {
      callback()
    }
  }

  for (i = 0; i &lt; emitters.length; i++) {
    emitters[i].once(event, increment)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.utils.deepCopy" id="apidoc.element.deepstream.io.utils.deepCopy">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>deepCopy
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">deepCopy = function (obj) {
  if (typeof obj === OBJECT) {
    return JSON.parse(JSON.stringify(obj))
  }
  return obj
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.utils.getRandomIntInRange" id="apidoc.element.deepstream.io.utils.getRandomIntInRange">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>getRandomIntInRange
        <span class="apidocSignatureSpan">(min, max)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRandomIntInRange = function (min, max) {
  return min + Math.floor(Math.random() * (max - min))
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  * @public
  * @returns {SocketWrapper|RpcProxy} alternativeProvider
  */
  getAlternativeProvider (rpcName, correlationId) {
const rpcData = this._rpcs.get(correlationId)

const subscribers = Array.from(this._subscriptionRegistry.getLocalSubscribers(rpcName))
let index = utils.<span class="apidocCodeKeywordSpan">getRandomIntInRange</span>(0, subscribers.length)

for (let n = 0; n &lt; subscribers.length; ++n) {
  if (!rpcData.providers.has(subscribers[index])) {
    rpcData.providers.add(subscribers[index])
    return subscribers[index]
  }
  index = (index + 1) % subscribers.length
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.utils.getUid" id="apidoc.element.deepstream.io.utils.getUid">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>getUid
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getUid = function () {
  return `${Date.now().toString(36)}-${(Math.random() * 10000000000000000000).toString(36)}`
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
const C = require('./constants/constants')

exports.get = function () {
  const options = {
/*
* General
*/
serverName: utils.<span class="apidocCodeKeywordSpan">getUid</span>(),
showLogo: true,
logLevel: C.LOG_LEVEL.INFO,

/*
* Connectivity
*/
port: 6020,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.utils.isOfType" id="apidoc.element.deepstream.io.utils.isOfType">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>isOfType
        <span class="apidocSignatureSpan">(input, expectedType)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isOfType = function (input, expectedType) {
  if (input === null) {
    return expectedType === 'null'
  } else if (expectedType === 'array') {
    return Array.isArray(input)
  } else if (expectedType === 'url') {
    return !!url.parse(input).host
  }
  return typeof input === expectedType
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  try {
    data = JSON.parse(message.data[2])
  } catch (e) {
    socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.INVALID_MESSAGE_DATA, message.raw)
    return
  }

  if (!utils.<span class="apidocCodeKeywordSpan">isOfType</span>(data, 'object') &amp;&amp; !utils.isOfType(data, &amp;#
x27;array')) {
    socketWrapper.sendError(C.TOPIC.RECORD, C.EVENT.INVALID_MESSAGE_DATA, message.raw)
    return
  }

  update.isPatch = false
  update.data = data
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.utils.merge" id="apidoc.element.deepstream.io.utils.merge">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>merge
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">merge = function () {
  const result = {}
  const objs = Array.prototype.slice.apply(arguments) // eslint-disable-line
  let i

  const _merge = (objA, objB) =&gt; {
    let key

    for (key in objB) {
      if (objB[key] &amp;&amp; objB[key].constructor === Object) {
        objA[key] = objA[key] || {}
        _merge(objA[key], objB[key])
      } else if (objB[key] !== undefined) {
        objA[key] = objB[key]
      }
    }
  }

  for (i = 0; i &lt; objs.length; i++) {
    _merge(result, objs[i])
  }

  return result
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 const cliArgs = {}
 let key

 for (key in defaultOptions.get()) {
   cliArgs[key] = typeof argv[key] === 'undefined' ? undefined : argv[key]
 }

 return utils.<span class="apidocCodeKeywordSpan">merge</span>({ plugins: {} }, defaultOptions.get(), config, cliArgs)
}

/**
* Checks if a config file is present at a given path
*
* @param   {String} configPath the path to the config file
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.utils.parseJSON" id="apidoc.element.deepstream.io.utils.parseJSON">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>parseJSON
        <span class="apidocSignatureSpan">(text, reviver)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parseJSON = function (text, reviver) {
  try {
    return {
      value: JSON.parse(text, reviver)
    }
  } catch (err) {
    return {
      error: err
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
const type = value.charAt(0)

if (type === C.TYPES.STRING) {
  return value.substr(1)
}

if (type === C.TYPES.OBJECT) {
  const result = utils.<span class="apidocCodeKeywordSpan">parseJSON</span>(value.substr(1))
  if (result.value) {
    return result.value
  }
  return result.error
}

if (type === C.TYPES.NUMBER) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.utils.reverseMap" id="apidoc.element.deepstream.io.utils.reverseMap">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>reverseMap
        <span class="apidocSignatureSpan">(map)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reverseMap = function (map) {
  const reversedMap = {}

  for (const key in map) {
    reversedMap[map[key]] = key
  }

  return reversedMap
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


'use strict'

const C = require('../constants/constants')
const utils = require('../utils/utils')

const actionToKey = utils.<span class="apidocCodeKeywordSpan">reverseMap</span>(C.ACTIONS)
const RULES_MAP = {}
const RULE_TYPES = {}

/**
* Different rule types support different features. Generally, all rules can
* use cross referencing _() to reference records, but only record writes, incoming events
* or RPC requests carry data and only existing records have a concept of oldData
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.utils.setInterval" id="apidoc.element.deepstream.io.utils.setInterval">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>setInterval
        <span class="apidocSignatureSpan">(callback, intervalDuration)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setInterval = function (callback, intervalDuration) {
  if (intervalDuration !== null) {
    return setInterval(callback, intervalDuration)
  }
  return -1
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.utils.setTimeout" id="apidoc.element.deepstream.io.utils.setTimeout">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>setTimeout
        <span class="apidocSignatureSpan">(callback, timeoutDuration)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setTimeout = function (callback, timeoutDuration) {
  if (timeoutDuration !== null) {
    return setTimeout(callback, timeoutDuration)
  }
  return -1
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  * @param  {String}   leaderServerName The leader of the cluster
  * @param  {Function} callback         The callback to invoke once a response
  *                                     from the server is retrieved
  * @private
  * @returns {void}
  */
  _getRemoteLock (name, leaderServerName, callback) {
this._timeouts[name] = utils.<span class="apidocCodeKeywordSpan">setTimeout</span>(
        this._onLockRequestTimeout.bind(this, name),
        this._options.lockRequestTimeout
    )

this._responseEventEmitter.once(name, callback)

const remoteTopic = this._getPrivateTopic(leaderServerName)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.utils.shuffleArray" id="apidoc.element.deepstream.io.utils.shuffleArray">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>shuffleArray
        <span class="apidocSignatureSpan">(array)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">shuffleArray = function (array) {
  for (let i = array.length - 1; i &gt; 0; i--) {
    const j = Math.floor(Math.random() * (i + 1))
    const temp = array[i]
    array[i] = array[j]
    array[j] = temp
  }
  return array
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  const set = new Set(servers)
  set.delete(this._options.serverName)

  if (!this._options.shuffleListenProviders) {
    return Array.from(set)
  }
  return utils.<span class="apidocCodeKeywordSpan">shuffleArray</span>(Array.from(set))
}

/**
* Create a map of all the listeners that patterns match the subscriptionName locally
* @param  {Object} patterns         All patterns currently on this deepstream node
* @param  {SusbcriptionRegistry} providerRegistry All the providers currently registered
* @param  {String} subscriptionName the subscription to find a provider for
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.utils.spliceRandomElement" id="apidoc.element.deepstream.io.utils.spliceRandomElement">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>spliceRandomElement
        <span class="apidocSignatureSpan">(array)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">spliceRandomElement = function (array) {
  const randomIndex = exports.getRandomIntInRange(0, array.length)
  return array.splice(randomIndex, 1)[0]
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.deepstream.io.utils.validateMap" id="apidoc.element.deepstream.io.utils.validateMap">
        function <span class="apidocSignatureSpan">deepstream.io.utils.</span>validateMap
        <span class="apidocSignatureSpan">(map, throwError, schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateMap = function (map, throwError, schema) {
  let error
  let key

  for (key in schema) {
    if (typeof map[key] === 'undefined') {
      error = new Error(`Missing key ${key}`)
      break
    }

    if (!exports.isOfType(map[key], schema[key])) {
      error = new Error(`Invalid type ${typeof map[key]} for ${key}`)
      break
    }
  }

  if (error) {
    if (throwError) {
      throw error
    } else {
      return error
    }
  } else {
    return true
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  * @param   {Object} settings
  *
  * @private
  * @returns {void}
  */
  _validateSettings (settings) { // eslint-disable-line
if (!settings.hash) {
  utils.<span class="apidocCodeKeywordSpan">validateMap</span>(settings, true, {
    path: 'string'
  })
  return
}

utils.validateMap(settings, true, {
  path: 'string',
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>